<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DMå¼€å‘å·¥å…·</title>
    <link rel="icon" href="./assets/favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="./css/index.css">
    <link rel="stylesheet" href="./common/layui/css/layui.css" />
    <link rel="stylesheet" href="./assets/css/theme.css">
    <link rel="stylesheet" href="./assets/css/countdown.css">
    <link rel="stylesheet" href="./assets/css/messageBoard.css">
    <script src="./common/layui/layui.js"></script>
    <script src="./common/components/Loading.js"></script>
    <script src="./common/components/animationLoading.js"></script>

    <style>
        /* åŸºæœ¬æ ·å¼ */
        #layout {
            display: flex;
            transition: margin-left 0.3s;
            position: relative;
        }

        #sidebar {
            width: 200px;
            background: var(--sidebar-bg);
            color: var(--sidebar-text);
            padding: 0;
            box-shadow: 2px 0 8px rgba(0, 0, 0, 0.15);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            overflow: hidden;
        }

        #sidebar-box {
            padding: 15px 20px;
            display: flex;
            align-items: center;
            background: rgba(0, 0, 0, 0.1);
            height: 60px;
            box-sizing: border-box;
        }

        #toggleSidebar {
            padding: 4px 8px;
            margin-right: 8px;
            background: transparent;
            border: none;
            color: inherit;
            font-size: 20px;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        #sidebar.collapsed {
            width: 60px;
            overflow: hidden;
        }

        #sidebar.collapsed #toggleSidebar {
            transform: rotate(-180deg);
        }

        #sidebar.collapsed .menu-header {
            padding: 12px 0;
            justify-content: center;
        }

        #sidebar.collapsed .menu-header:after {
            display: none;
        }

        #sidebar.collapsed .menu-item>a.menu-header {
            font-size: 0;
        }

        #sidebar.collapsed .menu-item>a.menu-header:before {
            content: 'â€¢';
            font-size: 16px;
        }

        #sidebar.collapsed .submenu {
            display: none !important;
            max-height: 0 !important;
        }

        #sidebar ul {
            padding: 0 8px;
        }

        #sidebar ul li {
            margin: 4px 0;
            border-radius: 4px;
        }

        #sidebar ul li a {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            color: inherit;
            text-decoration: none;
            cursor: pointer;
            transition: all 0.25s ease;
            white-space: nowrap;
        }

        #sidebar ul li:hover a {
            color: #fff;
            transform: translateX(4px);
            border-radius: 4px;
        }

        #main {
            height: 100vh;
            flex: 1;
            display: flex;
            flex-direction: column;
            transition: margin-left 0.3s;
        }

        .nav {
            display: flex;
            border-radius: 0%;
            color: var(--header-text) !important;
            background: var(--header-bg) !important;
        }

        .layui-nav-item a {
            color: var(--header-text);
        }

        .layui-nav-child a {
            color: #333 !important;
        }

        #content {
            padding: 15px;
            flex: 1;
            background-color: #f5f5f5;
            position: relative;
        }

        #content .iframeBox {
            width: 100%;
            height: 100%;
            border: 0;
            background-color: #fff;
            padding: 8px;
            border-radius: 8px;
        }

        .showIframe {
            display: block;
        }

        .hiddenIframe {
            display: none;
        }

        /* æ´»è·ƒæŒ‰é’®æ ·å¼ä¼˜åŒ– */
        .activeButton {
            background: var(--active-color) !important;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        .activeButton a {
            color: #fff !important;
            transform: none !important;
        }

        /* ä¸ºå¯¼èˆªæ·»åŠ accent color */
        .layui-nav .layui-nav-child dd:hover a {
            color: var(--accent-color) !important;
        }

        /* æ·»åŠ ä¸»é¢˜åˆ‡æ¢æ—¶çš„è¿‡æ¸¡æ•ˆæœ */
        #sidebar,
        .nav,
        .activeButton {
            transition: all 0.4s ease;
        }

        /* æ·»åŠ å­èœå•æ ·å¼ */
        #sidebar ul.submenu {
            padding-left: 15px;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        #sidebar .menu-item.active>ul.submenu {
            max-height: 500px;
            /* è¶³å¤Ÿå¤§çš„é«˜åº¦ä»¥å®¹çº³æ‰€æœ‰å­èœå•é¡¹ */
        }

        #sidebar .menu-header {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            color: inherit;
            text-decoration: none;
            cursor: pointer;
            transition: all 0.25s ease;
            white-space: nowrap;
            position: relative;
        }

        #sidebar .menu-header:after {
            content: 'â–¸';
            position: absolute;
            right: 16px;
            transition: transform 0.3s ease;
        }

        #sidebar .menu-item.active>.menu-header:after {
            transform: rotate(90deg);
        }

        #sidebar .menu-item.active>.menu-header {
            color: #fff;
            background: rgba(255, 255, 255, .1);
        }

        /* æ·»åŠ å­èœå•æ‚¬åœæ¸å˜æ•ˆæœ */
        #sidebar ul.submenu li:hover a {
            background: linear-gradient(90deg, rgba(255, 255, 255, 0.05), rgba(255, 255, 255, 0.2), rgba(255, 255, 255, 0.05));
            color: #fff;
            transform: translateX(4px);
            border-radius: 4px;
            transition: all 0.3s ease;
        }

        /* ä¿®æ”¹å­èœå•é¡¹æ ·å¼ */
        #sidebar ul.submenu li a {
            padding: 8px 16px;
            border-radius: 4px;
            transition: all 0.3s ease;
        }

        /* ç¡®ä¿å­èœå•é¡¹çš„èƒŒæ™¯è‰²åœ¨æ‚¬åœå‰æ˜¯é€æ˜çš„ */
        #sidebar ul.submenu li a {
            background: transparent;
        }

        #header-text {
            line-height: 60px;
            max-width: 450px;
            color: var(--header-text);
            padding-left: 20px;
            font-size: 0.8rem;
            letter-spacing: 0.5px;
            white-space: nowrap;
            overflow-x: auto;
            scrollbar-width: none;
            scrollbar-color: rgba(128, 128, 128, 0.1) transparent;
            backdrop-filter: blur(5px);
            transition: all 0.3s ease;
            border-radius: 22px;
            position: relative;
            overflow: hidden;
        }

        #header-text::-webkit-scrollbar {
            height: 1px;
        }

        #header-text::-webkit-scrollbar-track {
            background: transparent;
        }

        #header-text::-webkit-scrollbar-thumb {
            background-color: rgba(128, 128, 128, 0.5);
            border-radius: 3px;
        }

        #header-text:hover ::-webkit-scrollbar {
            background-color: rgba(128, 128, 128, 0.7);
            scrollbar-width: thin;
        }

        /* æ·»åŠ è®¾ç½®æŒ‰é’®å°åœ†ç‚¹æ ·å¼ */
        .layui-nav-item .settings-dot {
            display: inline-block;
            width: 8px;
            height: 8px;
            background-color: #ff4d4f;
            border-radius: 50%;
            margin-left: 6px;
            vertical-align: middle;
            position: relative;
            top: -1px;
        }
    </style>
</head>

<body>
    <div id="layout">
        <div id="sidebar">
            <div id="sidebar-box">
                <button id="toggleSidebar" aria-label="Toggle Sidebar">â˜°</button>
                <b>LOCALETOOL</b>
            </div>
            <hr style="border:none;height: 1px;">
            <ul id="toggleBtn">
                <li class="menu-item">
                    <a class="menu-header">æ£€æŸ¥å·¥å…·</a>
                    <ul class="submenu">
                        <li><a class="cBTN" name="icå¹³å°ä¹¦ç­¾æ£€æŸ¥å·¥å…·" path="icCheckTool">icCheckTool</a></li>
                        <li><a class="cBTN" name="æ–‡æœ¬å¯¹æ¯”å·¥å…·" path="codeDiff">codeDiff</a></li>
                    </ul>
                </li>
                <li class="menu-item">
                    <a class="menu-header">å¸¸ç”¨å·¥å…·</a>
                    <ul class="submenu">
                        <li><a class="cBTN" name="txtæ–‡æœ¬å»é™¤æ¢è¡Œ" path="txtnowrap">txtnowrap</a></li>
                        <li><a class="cBTN" name="æ ¼å¼åŒ–Url" path="formatUrl">formatUrl</a></li>
                        <li><a class="cBTN" name="è‹±æ–‡å‰åæ·»åŠ ç©ºæ ¼nbsp" path="nbspAdd">nbspAdd</a></li>
                        <li><a class="cBTN" name="å‹ç¼©jsä»£ç ä¸ºä¹¦ç­¾" path="compressCode">compressCode</a></li>
                        <li><a class="cBTN" name="ä¾¿ç­¾" path="note">note</a></li>
                        <li><a class="cBTN" name="ä¸´æ—¶é‚®ç®±" path="playApi/email">email</a></li>
                    </ul>
                </li>
                <li class="menu-item">
                    <a class="menu-header">DMå¼€å‘å·¥å…·</a>
                    <ul class="submenu">
                        <li><a class="cBTN" name="é¡¹ç›®å¤‡ä»½è‡ªåŠ¨æ‹¼å›¾+æˆªå›¾+å‘½åå¤åˆ¶" path="DM-standby">DM-standby</a></li>
                        <li><a class="cBTN" name="DM-QA" path="DM-QA">DM-QA</a></li>
                        <li><a class="cBTN" name="DMCohortDisplay" path="DMCohortDisplay">DMCohortDisplay</a></li>
                        <li><a class="cBTN" name="DMé¡¹ç›®å¸¸ç”¨æ–‡æœ¬ç”Ÿæˆ+ä¸€é”®å¤åˆ¶" path="DM-copyNote">DM-copyNote</a></li>
                    </ul>
                </li>
                <li class="menu-item">
                    <a class="menu-header">è”ç½‘</a>
                    <ul class="submenu">
                        <li><a class="cBTN" name="â˜ï¸ äº‘æœµèŠå¤©å®¤ â˜ï¸" path="dmChat">DM-Chat</a></li>
                    </ul>
                </li>
                <li class="menu-item">
                    <a class="menu-header">å…¶ä»–</a>
                    <ul class="submenu">
                        <li><a class="cBTN" name="è´ªåƒè›‡" path="game/snake">è´ªåƒè›‡</a></li>
                        <li><a class="cBTN" name="2048 å¡é€šç‰ˆ" path="game/2048">2048</a></li>
                        <li><a class="cBTN" name="æ‰“ç –å—" path="game/breakBricks">æ‰“ç –å—</a></li>
                        <li><a class="cBTN" name="è®°å¿†ç¿»ç‰Œæ¸¸æˆ" path="game/memoryMatch">è®°å¿†ç¿»ç‰Œæ¸¸æˆ</a></li>
                        <li><a class="cBTN" name="è¿è¿çœ‹" path="game/linkGame">è¿è¿çœ‹</a></li>
                        <li><a class="cBTN" name="æ•°å­—åå®¹é“" path="game/huarongdao">æ•°å­—åå®¹é“</a></li>
                        <li><a class="cBTN" name="å¾®åšçƒ­æœæ¦œ" path="playApi/weibo">å¾®åšçƒ­æœæ¦œ</a></li>
                        <li><a class="cBTN" name="å¤©æ°”é¢„æŠ¥" path="playApi/weather">å¤©æ°”é¢„æŠ¥</a></li>
                        <li><a class="cBTN" name="ç²¾ç¾å›¾åº“" path="playApi/pictures">ç²¾ç¾å›¾åº“</a></li>
                    </ul>
                </li>
            </ul>
        </div>
        <div id="main">
            <ul class="layui-nav nav layui-bg-gray">
                <li id="header" style="line-height: 60px;padding-right: 16px;font-weight: 700;">æ ‡é¢˜</li>
                <li id="header-text" style="text-align: left;display: none;">æš‚æ— å†…å®¹ï½</li>
                <li style="line-height: 60px;flex:1;"></li>
                <li class="layui-nav-item layui-this"><a href="">æš‚æ— </a></li>
                <li class="layui-nav-item"><a href="" aria-label="ç•™è¨€æ¿">ç•™è¨€æ¿</a></li>
                <li class="layui-nav-item">
                    <a href="javascript:;" class="layui-icon-set-fill layui-icon">è®¾ç½®</a>
                    <dl class="layui-nav-child">
                        <dd><a href="javascript:;" id="toggleCountdown">æ˜¾ç¤ºä¸‹ç­å€’è®¡æ—¶</a></dd>
                        <dd><a href="javascript:;" id="toggleDailyText">æ˜¾ç¤ºæ¯æ—¥ä¸€è¨€</a></dd>
                    </dl>
                </li>
                <li class="layui-nav-item">
                    <a href="javascript:;" class="layui-icon-theme layui-icon">ä¸»é¢˜åˆ‡æ¢</a>
                    <dl class="layui-nav-child">
                        <dd><a href="javascript:;" onclick="switchTheme('default')">âš« é»˜è®¤ä¸»é¢˜</a></dd>
                        <dd><a href="javascript:;" onclick="switchTheme('dark')">ğŸŒ™ æ·±é‚ƒå¤œç©º</a></dd>
                        <dd><a href="javascript:;" onclick="switchTheme('green')">ğŸŒ² æ¸…æ–°æ£®æ—</a></dd>
                        <dd><a href="javascript:;" onclick="switchTheme('purple')">ğŸ’œ ä¼˜é›…ç´«ç½—</a></dd>
                        <dd><a href="javascript:;" onclick="switchTheme('ocean')">ğŸŒŠ æµ·æ´‹ä¹‹å¿ƒ</a></dd>
                        <dd><a href="javascript:;" onclick="switchTheme('sunset')">ğŸŒ… æ™šéœæ©˜æš®</a></dd>
                        <dd><a href="javascript:;" onclick="switchTheme('cherry')">ğŸŒ¸ æ¨±èŠ±ç²‰éŸµ</a></dd>
                        <dd><a href="javascript:;" onclick="switchTheme('mint')">ğŸŒ¿ è–„è·æ¸…æ™¨</a></dd>
                        <dd><a href="javascript:;" onclick="switchTheme('tech')">ğŸ”µ ç§‘æŠ€è“è°ƒ</a></dd>
                        <dd><a href="javascript:;" onclick="switchTheme('coffee')">â˜• å’–å•¡æ—¶å…‰</a></dd>
                    </dl>
                </li>
                <li class="layui-nav-item">
                    <a style="cursor: pointer;" onclick="window.open('./pages/demo/index.html')">æœ€è¿‘æ›´æ–°å†…å®¹</a>
                </li>
            </ul>
            <div id="content">
                <!-- ç§»é™¤æ‰€æœ‰é™æ€ iframe æ ‡ç­¾ -->
            </div>
        </div>
    </div>

    <!-- å€’è®¡æ—¶å¡ç‰‡ -->
    <div class="countdown-card" id="countdownCard">
        <div class="countdown-header">
            <div class="countdown-title">
                <img src="./assets/icons/clock.png" class="countdown-icon" id="countdownIcon" alt="å€’è®¡æ—¶å›¾æ ‡">
            </div>
            <div class="countdown-desc" id="countdownDesc">è·ç¦»ä¸‹ç­è¿˜æœ‰</div>
            <img class="edit-icon" src="./assets/icons/set.png" alt="å€’è®¡æ—¶å›¾æ ‡"></img>
        </div>
        <div class="countdown-time" id="countdownTime">00:00:00</div>
    </div>

    <!-- è®¾ç½®é¢æ¿ -->
    <div class="settings-panel" id="settingsPanel">
        <div class="settings-header">
            <div class="settings-title">å·¥ä½œæ—¶é—´è®¾ç½®</div>
            <div class="close-settings" id="closeSettings">Ã—</div>
        </div>

        <div class="time-input-group">
            <label for="workStartTime">ä¸Šç­æ—¶é—´</label>
            <input type="time" id="workStartTime" class="time-input">
        </div>

        <div class="time-input-group">
            <label for="lunchStartTime">åˆä¼‘å¼€å§‹æ—¶é—´</label>
            <input type="time" id="lunchStartTime" class="time-input">
        </div>

        <div class="time-input-group">
            <label for="lunchEndTime">åˆä¼‘ç»“æŸæ—¶é—´</label>
            <input type="time" id="lunchEndTime" class="time-input">
        </div>

        <div class="time-input-group">
            <label for="workEndTime">ä¸‹ç­æ—¶é—´</label>
            <input type="time" id="workEndTime" class="time-input">
        </div>

        <div class="current-schedule">
            <h4>å½“å‰æ—¶é—´è¡¨</h4>
            <div class="schedule-item">
                <span>ä¸Šç­æ—¶é—´:</span>
                <span id="currentWorkStart">09:30</span>
            </div>
            <div class="schedule-item">
                <span>åˆä¼‘æ—¶é—´:</span>
                <span id="currentLunch">12:00 - 14:00</span>
            </div>
            <div class="schedule-item">
                <span>ä¸‹ç­æ—¶é—´:</span>
                <span id="currentWorkEnd">18:30</span>
            </div>
        </div>

        <div class="settings-footer">
            <button class="settings-btn hide-btn" id="hideCountdown" title="ä¸å†æ˜¾ç¤ºä¸‹ç­å€’è®¡æ—¶ï¼Œå¯åœ¨å¯¼èˆªæ è®¾ç½®ä¸­å¼€å¯">ä¸å†æ˜¾ç¤º</button>
            <button class="settings-btn cancel-btn" id="cancelSettings">å–æ¶ˆ</button>
            <button class="settings-btn save-btn" id="saveSettings">ä¿å­˜è®¾ç½®</button>
        </div>
    </div>

    <script>


        // è·å–ä¾§è¾¹æ å’ŒæŒ‰é’®
        const header = document.getElementById('header')
        const sidebar = document.getElementById('sidebar');
        const toggleSidebarButton = document.getElementById('sidebar-box');
        const toggleBtn = document.querySelectorAll('#toggleBtn li')
        const cBTN = document.querySelectorAll('.cBTN')
        const iframeBox = document.querySelectorAll('.iframeBox')

        // åˆå§‹åŒ–çŠ¶æ€
        let isCollapsed = false;

        // åˆ‡æ¢ä¾§è¾¹æ çš„å±•å¼€/æ”¶ç¼©çŠ¶æ€
        toggleSidebarButton.addEventListener('click', function toggleSidebar() {
            if (isCollapsed) {
                sidebar.classList.remove('collapsed');
                isCollapsed = false;
            } else {
                sidebar.classList.add('collapsed');
                isCollapsed = true;
            }
        });

        // è·å–æ‰€æœ‰èœå•å¤´éƒ¨
        const menuHeaders = document.querySelectorAll('.menu-header');

        // ä¸ºæ¯ä¸ªèœå•å¤´éƒ¨æ·»åŠ ç‚¹å‡»äº‹ä»¶
        menuHeaders.forEach(header => {
            header.addEventListener('click', function (e) {
                // é˜»æ­¢äº‹ä»¶å†’æ³¡ï¼Œé¿å…è§¦å‘çˆ¶å…ƒç´ çš„ç‚¹å‡»äº‹ä»¶
                e.stopPropagation();

                const menuItem = this.parentElement;

                // åˆ‡æ¢å½“å‰èœå•é¡¹çš„æ´»åŠ¨çŠ¶æ€
                menuItem.classList.toggle('active');

                // å¦‚æœä¾§è¾¹æ å¤„äºæŠ˜å çŠ¶æ€ï¼Œå±•å¼€å®ƒ
                if (sidebar.classList.contains('collapsed')) {
                    sidebar.classList.remove('collapsed');
                    isCollapsed = false;
                }
            });
        });

        // åœ¨ activeButton å‡½æ•°ä¹‹å‰æ·»åŠ æ–°çš„å‡½æ•°
        function createIframe(path, name) {
            const iframe = document.createElement('iframe');
            iframe.className = 'iframeBox';
            iframe.style.display = 'block';
            iframe.src = `./pages/${path}/index.html`;
            iframe.setAttribute('data-name', name);

            const loadingContainer = animationLoading.loaddingAnimation()

            try {

                // ç›‘å¬iframeåŠ è½½å®Œæˆäº‹ä»¶ï¼Œéšè—åŠ è½½åŠ¨ç”»
                iframe.onload = function () {
                    setTimeout(() => {
                        // è®¾ç½®è¿›åº¦ä¸º100%
                        if (loadingContainer.setProgress) {
                            loadingContainer.setProgress(100);
                        }

                        // è°ƒç”¨æ¸…ç†å‡½æ•°
                        if (loadingContainer.cleanup) {
                            loadingContainer.cleanup();
                        }

                        loadingContainer.style.display = 'none';
                    }, 300);
                };
            } catch (error) {
                console.log('iframeåŠ è½½å¤±è´¥', error);
                loadingContainer.style.display = 'none';
            }

            return iframe;
        }

        // ä¿®æ”¹ activeButton å‡½æ•°
        function activeButton(index) {
            const content = document.getElementById('content');
            const clickedBtn = cBTN[index];
            const name = clickedBtn.getAttribute('name');
            header.innerText = name;

            // éšè—æ‰€æœ‰ iframe
            const existingIframes = content.querySelectorAll('iframe');
            existingIframes.forEach(iframe => {
                iframe.style.display = 'none';
            });

            // æ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨å¯¹åº”çš„ iframe
            let targetIframe = content.querySelector(`iframe[data-name="${name}"]`);

            if (!targetIframe) {
                // åŠ¨æ€ç”Ÿæˆ pathMap
                const pathMap = {};
                document.querySelectorAll('.cBTN').forEach(btn => {
                    const btnName = btn.getAttribute('name');
                    const btnPath = btn.getAttribute('path');
                    if (btnName && btnPath) {
                        pathMap[btnName] = btnPath;
                    }
                });

                const path = pathMap[name];
                if (path) {
                    targetIframe = createIframe(path, name);
                    content.appendChild(targetIframe);
                }
            } else {
                // å¦‚æœiframeå·²å­˜åœ¨ï¼Œæ˜¾ç¤ºå®ƒ
                targetIframe.style.display = 'block';
            }

            // ç§»é™¤æ‰€æœ‰èœå•é¡¹çš„æ´»åŠ¨çŠ¶æ€
            document.querySelectorAll('.activeButton').forEach(item => {
                item.classList.remove('activeButton');
            });

            // ä¸ºå½“å‰ç‚¹å‡»çš„èœå•é¡¹æ·»åŠ æ´»åŠ¨çŠ¶æ€
            clickedBtn.parentElement.classList.add('activeButton');

            // å±•å¼€åŒ…å«å½“å‰èœå•é¡¹çš„çˆ¶èœå•
            const parentMenuItem = clickedBtn.closest('.menu-item');
            if (parentMenuItem) {
                parentMenuItem.classList.add('active');
            }
        }

        // åˆå§‹åŒ–æ¿€æ´»ä¿å­˜çš„èœå•é¡¹
        const savedIndex = sessionStorage.getItem('cy_activeButton_current_index') || 0;
        activeButton(parseInt(savedIndex));

        // ä¸ºæ¯ä¸ªèœå•é¡¹æ·»åŠ ç‚¹å‡»äº‹ä»¶
        for (let index = 0; index < cBTN.length; index++) {
            cBTN[index].onclick = function (e) {
                // é˜»æ­¢äº‹ä»¶å†’æ³¡
                e.stopPropagation();

                // æ¿€æ´»å½“å‰ç‚¹å‡»çš„èœå•é¡¹
                activeButton(index);
                sessionStorage.setItem('cy_activeButton_current_index', index);
            }
        }


        // åŠ è½½åŠ¨ç”»


    </script>

    <!-- æ·»åŠ ä¸»é¢˜å’Œå€’è®¡æ—¶è„šæœ¬å¼•ç”¨ -->
    <script src="./assets/js/theme.js"></script>
    <script src="./assets/js/countdown.js"></script>
    <script src="./assets/js/messageBoard.js"></script>

    <!-- æ·»åŠ æ¯æ—¥ä¸€è¨€å†…å®¹ -->
    <script src="./assets/js/daily-sentence.js"></script>


</body>

</html>