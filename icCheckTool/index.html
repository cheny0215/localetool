<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>文本对比工具</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.3/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.3/theme/elegant.min.css">
    <style>
        body {
            font-family: Arial, sans-serif;
        }

        .signs {
            color: #bebdbd;
            font-size: 12px;
            padding: 5px;
        }

        .dragText {
            width: 50px;
            height: 30px;
            padding: 8px;
            margin: 0px 8px;
            line-height: 15px;
            font-size: 12px;
            display: block;
            margin-top: 20px;
            border-radius: 4px;
            background-color: rgb(136 39 39);
            border: 1px solid rgb(220, 156, 156);
            color: #fff;
            text-decoration: none;
            text-align: center;
        }

        .a-box {
            display: flex;
        }
    </style>
</head>

<body>
    <div class="signs">将以下元素拖拽到浏览器上方<br>即可存为书签直接使用</div>
    <div class="a-box">

        <a class="dragText"
            href='javascript:(function(){let checkPadding_bol=document.getElementById("iframe_0").contentWindow.document.querySelectorAll(`div[style*="pointer-events: none"]`);function checkPadding(){let iframewindow_des=document.getElementById("iframe_0").contentWindow;let iframewindow_mob=document.getElementById("iframe_1").contentWindow;if(checkPadding_bol.length==0){function highlightPadding(element,level,iframewindow){const colors=["rgba(255, 0, 0, 0.5)","rgba(0, 0, 255, 0.5)","rgba(255, 255, 0, 0.5)"];const color=colors[level%colors.length];const style=iframewindow.getComputedStyle(element);const paddingRight=parseFloat(style.paddingRight);const paddingLeft=parseFloat(style.paddingLeft);if(paddingRight>0||paddingLeft>0){const paddingOverlay=document.createElement("div");paddingOverlay.style.position="absolute";paddingOverlay.style.top=0;paddingOverlay.style.left=0;paddingOverlay.style.width="100%";paddingOverlay.style.height="100%";paddingOverlay.style.boxSizing="border-box";paddingOverlay.style.pointerEvents="none";paddingOverlay.style.borderRight=paddingRight+"px solid "+color;paddingOverlay.style.borderLeft=paddingLeft+"px solid "+color;element.appendChild(paddingOverlay);element.style.position="relative";}Array.from(element.children).forEach(child=>highlightPadding(child,level+1,iframewindow));}highlightPadding(document.getElementById("iframe_0").contentWindow.document.body,0,iframewindow_des);highlightPadding(document.getElementById("iframe_1").contentWindow.document.body,0,iframewindow_mob);}else{function clearPaddingHighlights(iframewindow){const overlays=iframewindow.document.querySelectorAll(`div[style*="pointer-events: none"]`);overlays.forEach(overlay=>{overlay.parentElement.style.position="";overlay.remove();});}clearPaddingHighlights(document.getElementById("iframe_0").contentWindow);clearPaddingHighlights(document.getElementById("iframe_1").contentWindow);}}checkPadding();})();'>Padding
            Check</a>

        <a class="dragText"
            href="javascript:(function(){let iframewindow_des=document.getElementById('iframe_0').contentWindow,iframewindow_mob=document.getElementById('iframe_1').contentWindow,link1='',link2='';const diffBoxs=document.createElement('div');diffBoxs.className='diffBox';const header=document.createElement('div');const headerText=document.createElement('span');headerText.textContent='对比结果: ';const toggleButton=document.createElement('span');toggleButton.className='clkTosmalls';toggleButton.textContent='收起>';const toggleClickButton=document.createElement('span');toggleClickButton.className='clkToclear';toggleClickButton.textContent='清空文本';const toggleStyleButton=document.createElement('span');toggleStyleButton.className='clkTostyle';toggleStyleButton.textContent='链接样式';const toggleBlankButton=document.createElement('span');toggleBlankButton.className='clkToblank';toggleBlankButton.textContent='打开链接';header.appendChild(headerText);header.appendChild(toggleButton);header.appendChild(toggleClickButton);header.appendChild(toggleStyleButton);header.appendChild(toggleBlankButton);const diffLink=document.createElement('div');diffLink.appendChild(document.createElement('div'));diffLink.appendChild(document.createElement('div'));diffLink.id='diff-link';diffBoxs.appendChild(header);diffBoxs.appendChild(diffLink);document.body.appendChild(diffBoxs);const style=document.createElement('style');const script=document.createElement('script');style.textContent=`a.highlight{color:red!important;font-weight:bold!important;text-decoration:underline!important;background:yellow!important;padding:5px!important;border:2px solid black!important;}.diff{background-color:yellow;}.diffBox{width:100%;position:fixed;top:0;background-color:rgba(255,255,255,0.93);padding:10px 0;border:1px solid #666;}.diff-output{width:100%;overflow:auto;white-space:nowrap;margin-top:10px;border:1px solid #ddd;padding:4px;font-size:14px;}.diff-added{background-color:#d4fcbc;}.diff-removed{background-color:#fbb6c2;}.clkTosmalls,.clkToclear,.clkTostyle,.clkToblank{font-size:12px;color:#000;background-color:#b6d5fb;cursor:pointer;border:1px solid #000;padding:5px;border-radius:4px;margin-right:4px;white-space:nowrap;}`;const iframeStyle_des=iframewindow_des.document.createElement('style');const iframeStyle_mob=iframewindow_mob.document.createElement('style');iframeStyle_des.textContent=`a.highlight{color:red!important;font-weight:bold!important;text-decoration:underline!important;background:yellow!important;padding:5px!important;border:2px solid black!important;}`;iframeStyle_mob.textContent=`a.highlight{color:red!important;font-weight:bold!important;text-decoration:underline!important;background:yellow!important;padding:5px!important;border:2px solid black!important;}`;script.src=`https://cdnjs.cloudflare.com/ajax/libs/jsdiff/5.0.0/diff.min.js`;document.head.appendChild(style);iframewindow_des.document.head.appendChild(iframeStyle_des);iframewindow_mob.document.head.appendChild(iframeStyle_mob);document.head.appendChild(script);const links_des=iframewindow_des.document.querySelectorAll('a'),links_mob=iframewindow_mob.document.querySelectorAll('a'),diffBox=document.querySelector('.diffBox'),clkTosmalls=document.querySelector('.clkTosmalls'),clkToclear=document.querySelector('.clkToclear'),clkTostyle=document.querySelector('.clkTostyle'),clkToblank=document.querySelector('.clkToblank'),spanslist=document.querySelectorAll('#diff-link div');toggleButton.onclick=()=>{if(spanslist[0].style.display==='none'){spanslist[0].style.display='block';spanslist[1].style.display='block';toggleButton.textContent='收起>'}else{spanslist[0].style.display='none';spanslist[1].style.display='none';toggleButton.textContent='展开<'}};let clkTosmalls_switch=true;clkTosmalls.addEventListener('click',function(){clkTosmalls_switch?diffBox.style.width='10%':diffBox.style.width='100%';clkTosmalls_switch=!clkTosmalls_switch});clkToclear.addEventListener('click',function(){spanslist[0].innerText=link1='';spanslist[1].innerText=link2=''});clkToblank.addEventListener('click',function(){[link1,link2].forEach((url,index)=>{window.open(url,'_blank',`width=800,height=600,top=${200+index*50},left=${index*500},`);})});function changeIframeLinkStyle(links){clkTostyle.addEventListener('click',function(){if(links[0].classList.contains('highlight')){links.forEach(link=>{link.classList.remove('highlight')})}else{links.forEach(link=>{link.classList.add('highlight')})}});links.forEach(link=>{link.classList.add('highlight');link.addEventListener('click',function(event){event.preventDefault();compareLinks(link)})})}changeIframeLinkStyle(links_des);changeIframeLinkStyle(links_mob);function compareLinks(link){if(link1&&link2){spanslist[0].innerText=link1=spanslist[1].innerText=link2=''}link1=link2;link2=link.href;console.log('link1:',link1,'link2:',link2);var diff=Diff.diffWords(link1,link2);console.log('diff',diff);var difflink1=diff.map(function(part){var color=part.removed?'diff-removed':'';if((!part.removed&&!part.added)||part.removed){return`<span class='${color}'>${part.value.replace(/\n/g,'<br>')}</span>`}}).join('');var difflink2=diff.map(function(part){var color=part.added?'diff-added':'';if((!part.removed&&!part.added)||part.added){return`<span class='${color}'>${part.value.replace(/\n/g,'<br>')}</span>`}}).join('');spanslist.forEach(o=>{o.classList.add('diff-output')});spanslist[0].innerHTML=difflink1;spanslist[1].innerHTML=difflink2}})();">Link
            Compare</a>

        <a class="dragText"
            href="javascript:(function(){const frame0=document.getElementById('iframe_0'),frame1=document.getElementById('iframe_1'),frame2=document.getElementById('iframe_2');const htmlElement=`<div class='diff-output'><div style='padding: 5px 8px;'><button class='cyBtn'>收起</button><button class='cyBtn'>Desktop/Mobile文本对比</button><button class='cyBtn'>HTML/TXT文本对比</button><button class='cyBtn'>Desktop/Mobile链接对比</button></div><div class='diff-title'><strong></strong><strong></strong></div><div class='diff-box'><div></div><div></div></div></div>`;const script=document.createElement('script');script.src=`https://cdnjs.cloudflare.com/ajax/libs/jsdiff/5.0.0/diff.min.js`;document.head.appendChild(script);const style=document.createElement('style');style.textContent=`.diff-added{background-color:#b4fb8b;}.diff-removed{background-color:#fa92a3;}.diff-box{display:flex;justify-content:space-between;padding:0 10px;}.diff-box>div{width:48%;border:1px solid #999;font-size:14px;padding:10px;}.diff-output{width:100%;max-height:100vh;overflow:auto;position:fixed;top:0;background-color:rgba(255,250,254,0.98);padding:10px 0;border:1px solid #666;box-shadow:0 4px 8px rgba(0,0,0,0.2);}.cyBtn{margin-right:8px;cursor:pointer;background-color:#f2bcd9;border:1px solid rgb(36,61,86);border-radius:4px;padding:3px 4px;font-size:12px;font-weight:700;}.cyBtn:hover{background-color:#f8d0e5;}.diff-title{display:flex;justify-content:space-around;}.diff_linkbox{border:1px solid #999;font-size:14px;padding:6px;overflow:auto;white-space:nowrap;box-sizing:border-box;}.diff_linkbox::-webkit-scrollbar{display:none;}`;document.head.appendChild(style);document.body.insertAdjacentHTML('beforeend',htmlElement);let diffCount1=0,diffCount2=0;const spansText=document.querySelectorAll('.diff-box div'),cyBtn=document.querySelectorAll('.cyBtn'),diffTitle=document.querySelectorAll('.diff-title strong'),desktopContainer=frame0.contentWindow.document.querySelector('.desktop-container'),mobileContainer=frame0.contentWindow.document.querySelector('.mobile-container'),tableContainer=frame0.contentWindow.document.querySelector('table'),txtContainer=frame2.contentWindow.document.body,diffOutput=document.querySelector('.diff-output'),text_desktopContainer=desktopContainer.textContent.replace(/\s+/g,' ').trim(),text_mobileContainer=mobileContainer.textContent.replace(/\s+/g,' ').trim(),text_txtContainer=txtContainer.textContent.replace(/\s+/g,' ').replace(/https:\/\/[^\s]+/g,'').replace(/-{2,}\s*/g,'').trim(),text_htmlContainer=tableContainer.textContent.replace(/\s+/g,' ').trim();function getAllLinks(container){const links=container.querySelectorAll('a');return Array.from(links).map(link=>link.href);}const link_desktopContainer=getAllLinks(desktopContainer),link_mobileContainer=getAllLinks(mobileContainer);function compareTexts(text1,text2){diffCount1=diffCount2=0;let diff=Diff.diffWords(text1,text2);const diff_text1=diff.map(function(part){diffCount1=part.removed?diffCount1+1:diffCount1;const color=part.removed?'diff-removed':'';if((!part.removed&&!part.added)||part.removed){return`<span class='${color}'>${part.value.replace(/\n/g,'<br>')}</span>`;}}).join('');const diff_text2=diff.map(function(part){diffCount2=part.added?diffCount2+1:diffCount2;const color=part.added?'diff-added':'';if((!part.removed&&!part.added)||part.added){return`<span class='${color}'>${part.value.replace(/\n/g,'<br>')}</span>`;}}).join('');spansText[0].innerHTML=diff_text1;spansText[1].innerHTML=diff_text2;}function compareLinks(link1,link2){let diff=Diff.diffLines(link1,link2);const diff_link1=diff.map(function(part){diffCount1=part.removed?diffCount1+1:diffCount1;const color=part.removed?'diff-removed':'';if((!part.removed&&!part.added)||part.removed){return`<span class='${color}'>${part.value.replace(/\n/g,'<br>')}</span>`;}}).join('');const diff_link2=diff.map(function(part){diffCount2=part.added?diffCount2+1:diffCount2;const color=part.added?'diff-added':'';if((!part.removed&&!part.added)||part.added){return`<span class='${color}'>${part.value.replace(/\n/g,'<br>')}</span>`;}}).join('');spansText[0].insertAdjacentHTML('beforeend',`<div class='diff_linkbox'>${diff_link1}<div>`);spansText[1].insertAdjacentHTML('beforeend',`<div class='diff_linkbox'>${diff_link2}<div>`);}cyBtn[1].addEventListener('click',function(){compareTexts(text_desktopContainer,text_mobileContainer);diffTitle[0].innerHTML=`Desktop文本 <span class='diff-removed'>diff: ${diffCount1}</span>`;diffTitle[1].innerHTML=`Mobile文本 <span class='diff-added'>diff: ${diffCount2}</span>`;});cyBtn[2].addEventListener('click',function(){compareTexts(text_htmlContainer,text_txtContainer);diffTitle[0].innerHTML=`HTML文本 <span class='diff-removed'>diff: ${diffCount1}</span>`;diffTitle[1].innerHTML=`TXT文本 <span class='diff-added'>diff: ${diffCount2}</span>`;});cyBtn[3].addEventListener('click',function(){diffCount1=diffCount2=0;spansText[0].innerHTML='';spansText[1].innerHTML='';link_desktopContainer.forEach((link,index)=>{compareLinks(link,link_mobileContainer[index])});diffTitle[0].innerHTML=`Desktop链接 <span class='diff-removed'>diff: ${diffCount1}</span>`;diffTitle[1].innerHTML=`Mobile链接 <span class='diff-added'>diff: ${diffCount2}</span>`;});cyBtn[0].addEventListener('click',function(){const smalls=diffOutput.style.height;if(smalls=='100px'){diffOutput.style.height='auto';diffOutput.style.width='100%';cyBtn[0].innerText='收起';}else{diffOutput.style.height='100px';diffOutput.style.width='150px';cyBtn[0].innerText='展开';}})})();">Text
            Compare</a>

    </div>
    <script>
    </script>

</body>

</html>