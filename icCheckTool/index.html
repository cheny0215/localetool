<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>文本对比工具</title>
    <link rel="stylesheet" href="../css/index.css">
    <link rel="stylesheet" href="../common/layui/css/layui.css"/>
    <script src="../common/layui/layui.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.3/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.3/theme/elegant.min.css">
    <style>
        body {
            font-family: Arial, sans-serif;
        }

        /* 替换原有的按钮样式 */
        .layui-btn {
            position: relative;
            overflow: hidden;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            margin: 0 8px;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 0 16px 0 12px;
            height: 36px;
            line-height: 36px;
            border-radius: 12px;
            font-weight: 500;
            letter-spacing: 0.5px;
            color: #2a2a2a;
            cursor: move;  /* 显示可拖动的光标 */
            user-select: none;  /* 防止文字被选中 */
            transition: all 0.2s ease;
        }

        /* 悬停效果 */
        .layui-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 12px rgba(0, 0, 0, 0.15);
            border-color: rgba(255, 255, 255, 0.4);
        }

        /* 点击效果 */
        .layui-btn:active {
            transform: translateY(1px);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        /* 流光效果 */
        .layui-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                120deg,
                transparent,
                rgba(255, 255, 255, 0.6),
                transparent
            );
            transform: skewX(-25deg);
            transition: 0.75s;
        }

        .layui-btn:hover::before {
            left: 100%;
        }

        /* 为不同颜色的按钮添加渐变效果 */
        .layui-border-green {
            background: linear-gradient(
                135deg,
                rgba(34, 197, 94, 0.15),
                rgba(16, 185, 129, 0.1)
            );
            border-color: rgba(34, 197, 94, 0.3) !important;
            color: #009e3a !important;
        }

        .layui-border-blue {
            background: linear-gradient(
                135deg,
                rgba(59, 130, 246, 0.15),
                rgba(37, 99, 235, 0.1)
            );
            border-color: rgba(59, 130, 246, 0.3) !important;
            color: #1d4ed8 !important;
        }

        .layui-border-orange {
            background: linear-gradient(
                135deg,
                rgba(249, 115, 22, 0.15),
                rgba(234, 88, 12, 0.1)
            );
            border-color: rgba(249, 98, 11, 0.3) !important;
            color: #fb5b1b !important;
        }

        .layui-border-red {
            background: linear-gradient(
                135deg,
                rgba(239, 68, 68, 0.15),
                rgba(220, 38, 38, 0.1)
            );
            border-color: rgba(239, 68, 68, 0.3) !important;
            color: #b91c1c !important;
        }

        .layui-border-purple {
            background: linear-gradient(
                135deg,
                rgba(147, 51, 234, 0.15),
                rgba(126, 34, 206, 0.1)
            );
            border-color: rgba(147, 51, 234, 0.3) !important;
            color: #7e22ce !important;
        }

        /* 悬停时的特殊效果 */
        .layui-border-green:hover {
            background: linear-gradient(
                135deg,
                rgba(34, 197, 94, 0.25),
                rgba(16, 185, 129, 0.2)
            );
            box-shadow: 0 8px 12px rgba(34, 197, 94, 0.15);
        }

        .layui-border-blue:hover {
            background: linear-gradient(
                135deg,
                rgba(59, 130, 246, 0.25),
                rgba(37, 99, 235, 0.2)
            );
            box-shadow: 0 8px 12px rgba(59, 130, 246, 0.15);
        }

        .layui-border-orange:hover {
            background: linear-gradient(
                135deg,
                rgba(249, 115, 22, 0.25),
                rgba(234, 88, 12, 0.2)
            );
            box-shadow: 0 8px 12px rgba(249, 115, 22, 0.15);
        }

        .layui-border-red:hover {
            background: linear-gradient(
                135deg,
                rgba(239, 68, 68, 0.25),
                rgba(220, 38, 38, 0.2)
            );
            box-shadow: 0 8px 12px rgba(239, 68, 68, 0.15);
        }

        .layui-border-purple:hover {
            background: linear-gradient(
                135deg,
                rgba(147, 51, 234, 0.25),
                rgba(126, 34, 206, 0.2)
            );
            box-shadow: 0 8px 12px rgba(147, 51, 234, 0.15);
        }

        /* 添加点击波纹效果 */
        .layui-btn::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 5px;
            height: 5px;
            background: rgba(255, 255, 255, 0.9);
            opacity: 0;
            border-radius: 100%;
            transform: scale(1) translate(-50%, -50%);
            transform-origin: 50% 50%;
        }

        .layui-btn:active::after {
            animation: ripple 0.6s ease-out;
        }

        @keyframes ripple {
            0% {
                transform: scale(0) translate(-50%, -50%);
                opacity: 0.8;
            }
            100% {
                transform: scale(20) translate(-50%, -50%);
                opacity: 0;
            }
        }

        /* 添加按钮内文字效果 */
        .layui-btn {
            font-weight: 500;
            letter-spacing: 0.5px;
            text-shadow: 0 1px 1px rgba(0, 0, 0, 0.1);
        }

        .layui-btn:after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 5px;
            height: 5px;
            background: rgba(255, 255, 255, 0.5);
            opacity: 0;
            border-radius: 100%;
            transform: scale(1, 1) translate(-50%);
            transform-origin: 50% 50%;
        }

        .layui-btn:active:after {
            animation: ripple 0.6s ease-out;
        }

        @keyframes ripple {
            0% {
                transform: scale(0, 0);
                opacity: 0.5;
            }
            100% {
                transform: scale(20, 20);
                opacity: 0;
            }
        }

        /* 优化signs元素样式 */
        .signs {
            color: #88aadc;  /* 更柔和的文字颜色 */
            font-size: 13px;
            padding: 16px 0;
            line-height: 1.6;
            letter-spacing: 0.3px;
            position: relative;
            margin-bottom: 20px;
            display: inline-block;
        }

        /* 添加装饰性元素 */
        .signs::before {
            content: '';  /* 使用emoji作为图标 */
            margin-right: 8px;
            font-size: 16px;
        }

        /* 添加底部装饰线 */
        .signs::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 2px;
            background: linear-gradient(
                to right,
                rgba(99, 102, 241, 0.3),
                rgba(99, 102, 241, 0.1)
            );
            border-radius: 2px;
        }

        /* 优化换行样式 */
        .signs br {
            content: '';
            display: block;
            margin: 4px 0;
        }

        /* 添加文字阴影效果 */
        .signs {
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
        }

        /* 添加悬停效果 */
        .signs:hover::after {
            background: linear-gradient(
                to right,
                rgba(99, 102, 241, 0.5),
                rgba(99, 102, 241, 0.2)
            );
        }

        /* 修改.a-box的样式以支持拖拽排序 */
        .a-box {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            padding: 10px 0;
            min-height: 50px;
        }

        /* 拖动时的样式 */
        .layui-btn.dragging {
            opacity: 0.5;
            transform: scale(1.05);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
        }

        /* 放置目标的样式 */
        .layui-btn.drag-over {
            transform: scale(1.05);
            box-shadow: 0 0 0 2px rgba(99, 102, 241, 0.5);
        }

        /* 添加拖动时的占位样式 */
        .placeholder {
            border: 2px dashed rgba(99, 102, 241, 0.3);
            background: rgba(99, 102, 241, 0.1);
            border-radius: 12px;
            min-width: 120px;
            height: 36px;
        }

    </style>
</head>

<body style="padding-left: 10px;">
    <div class="signs">将以下元素拖拽到浏览器上方<br>即可存为书签直接使用。</div>
       <div class="a-box">

        <a class="layui-btn layui-btn-primary layui-border-green layui-btn-radius"
            href="javascript:(function(){let checkPadding_bol=document.getElementById('iframe_0').contentWindow.document.querySelectorAll(`div[style*='pointer-events: none']`);function checkPadding(){let iframewindow_des=document.getElementById('iframe_0').contentWindow;let iframewindow_mob=document.getElementById('iframe_1').contentWindow;if(checkPadding_bol.length==0||checkPadding_bol.length==1){function highlightPadding(element,level,iframewindow){const colors=['rgba(255, 0, 0, 0.5)','rgba(0, 0, 255, 0.5)','rgba(255, 255, 0, 0.5)'];const color=colors[level%colors.length];const style=iframewindow.getComputedStyle(element);const paddingRight=parseFloat(style.paddingRight);const paddingLeft=parseFloat(style.paddingLeft);if(paddingRight>0||paddingLeft>0){const paddingOverlay=document.createElement('div');paddingOverlay.style.position='absolute';paddingOverlay.style.top=0;paddingOverlay.style.left=0;paddingOverlay.style.width='100%';paddingOverlay.style.height='100%';paddingOverlay.style.boxSizing='border-box';paddingOverlay.style.pointerEvents='none';paddingOverlay.style.borderRight=paddingRight+'px solid '+color;paddingOverlay.style.borderLeft=paddingLeft+'px solid '+color;element.appendChild(paddingOverlay);element.style.position='relative';}Array.from(element.children).forEach(child=>highlightPadding(child,level+1,iframewindow));}highlightPadding(document.getElementById('iframe_0').contentWindow.document.body,0,iframewindow_des);highlightPadding(document.getElementById('iframe_1').contentWindow.document.body,0,iframewindow_mob);}else{function clearPaddingHighlights(iframewindow){const overlays=iframewindow.document.querySelectorAll(`div[style*='pointer-events: none']`);overlays.forEach(overlay=>{overlay.parentElement.style.position='';overlay.remove();});}clearPaddingHighlights(document.getElementById('iframe_0').contentWindow);clearPaddingHighlights(document.getElementById('iframe_1').contentWindow);}}checkPadding();})();">Padding
            Check</a>

        <a class="layui-btn layui-btn-primary layui-border-green layui-btn-radius"
            href="javascript:(function()%7Blet%20iframewindow_des=document.getElementById('iframe_0').contentWindow,iframewindow_mob=document.getElementById('iframe_1').contentWindow,link1='',link2='',openedWindows=%5B%5D,uikit_link=document.createElement('link');uikit_link.rel='stylesheet';uikit_link.href='https://cdn.jsdelivr.net/npm/uikit@3.21.9/dist/css/uikit.min.css';let%20uikit_script=document.createElement('script');uikit_script.src='https://cdn.jsdelivr.net/npm/uikit@3.21.9/dist/js/uikit.min.js';uikit_script.defer=true;let%20head=document.head%7C%7Cdocument.getElementsByTagName('head')%5B0%5D;head.appendChild(uikit_link);head.appendChild(uikit_script);document.body.insertAdjacentHTML('beforeend','%3Cdiv%20class=%5C'diffBox%5C'%3E%3Cdiv%3E%3Cbutton%20class=%5C'uk-button%20uk-button-secondary%20clkTosmalls%5C'%3E收起%3C%3C/button%3E%3Cbutton%20class=%5C'uk-button%20uk-button-danger%20clkToclear%5C'%3E清空链接%3C/button%3E%3Cbutton%20class=%5C'uk-button%20uk-button-secondary%20clkToblank%5C'%3E打开链接%3C/button%3E%3Cbutton%20class=%5C'uk-button%20uk-button-danger%20clkToclose%5C'%3E关闭窗口%3C/button%3E%3C/div%3E%3Cdiv%20id=%5C'diff-link%5C'%3E%3Cdiv%3E%3C/div%3E%3Cdiv%3E%3C/div%3E%3C/div%3E%3C/div%3E');const%20style=document.createElement('style');const%20diff_script=document.createElement('script');style.textContent='.diff%7Bbackground-color:yellow%7D.diffBox%7Bwidth:100%25;position:fixed;top:0;background-color:rgba(255,255,255,.98);padding:10px%208px;border:1px%20solid%20%23666%7D.diff-output%7Bwidth:100%25;overflow:auto;white-space:nowrap;margin-top:10px;border:1px%20solid%20%23ddd;padding:4px;font-size:14px%7D.diff-added%7Bbackground-color:%23d4fcbc;border:%201px%20solid%20%2368c72f;padding:%203px%201px;%7D.diff-removed%7Bbackground-color:%23ffb2c0;border:%201px%20solid%20%23df4963;padding:%203px%201px;%7D.clkTosmalls,.clkToclear,.clkToblank%7Bwhite-space:nowrap%7D.uk-button%7Bmargin-right:6px;border-radius:4px;font-size:14px;width:65px;line-height:22px;padding:0%7D';const%20iframeStyle_des=iframewindow_des.document.createElement('style');const%20iframeStyle_mob=iframewindow_mob.document.createElement('style');const%20highlightStyle='a.highlight%7Bcolor:red!important;font-weight:bold!important;text-decoration:underline!important;background-color:yellow!important;padding:5px!important;border:2px%20solid%20black!important%7Da.highlight_active%7Bbackground:orange!important%7D';iframeStyle_des.textContent=highlightStyle;iframeStyle_mob.textContent=highlightStyle;diff_script.src='https://cdnjs.cloudflare.com/ajax/libs/jsdiff/5.0.0/diff.min.js';document.head.appendChild(style);iframewindow_des.document.head.appendChild(iframeStyle_des);iframewindow_mob.document.head.appendChild(iframeStyle_mob);document.head.appendChild(diff_script);const%20links_des=iframewindow_des.document.querySelectorAll('a');const%20links_mob=iframewindow_mob.document.querySelectorAll('a');const%20diffBox=document.querySelector('.diffBox');const%20clkTosmalls=document.querySelector('.clkTosmalls');const%20clkToclear=document.querySelector('.clkToclear');const%20clkToblank=document.querySelector('.clkToblank');const%20clkToclose=document.querySelector('.clkToclose');const%20spanslist=document.querySelectorAll('%23diff-link%20div');let%20clkTosmalls_switch=true;function%20changeIframeLinkStyle(e)%7Be.forEach(l=%3E%7Bl.classList.add('highlight');l.addEventListener('click',function(n)%7Bn.preventDefault();l.classList.add('highlight_active');compareLinks(l)%7D)%7D)%7Dfunction%20compareLinks(e)%7Bif(link1&&link2)%7Bspanslist%5B0%5D.innerText=link1=spanslist%5B1%5D.innerText=link2=''%7Dlink2=link1?e.href:'';link1=link1?link1:e.href;var%20n=Diff.diffWords(link1,link2);var%20t=n.map(function(p)%7Bvar%20c=p.removed?'diff-removed':'';if(!p.removed&&!p.added%7C%7Cp.removed)return'%3Cspan%20class=%5C''+c+'%5C'%3E'+p.value.replace(/%5C%5Cn/g,'%3Cbr%3E')+'%3C/span%3E'%7D).join('');var%20i=n.map(function(p)%7Bvar%20c=p.added?'diff-added':'';if(!p.removed&&!p.added%7C%7Cp.added)return'%3Cspan%20class=%5C''+c+'%5C'%3E'+p.value.replace(/%5C%5Cn/g,'%3Cbr%3E')+'%3C/span%3E'%7D).join('');spanslist.forEach(s=%3Es.classList.add('diff-output'));spanslist%5B0%5D.innerHTML=t;spanslist%5B1%5D.innerHTML=i%7Dfunction%20handleOpenedWindows(e)%7Be.preventDefault();if(openedWindows.length%3E0)clkToclose.click();else%20if(link1&&link2)clkToblank.click()%7DclkTosmalls.onclick=()=%3E%7Bif(spanslist%5B0%5D.style.display==='none')%7Bspanslist%5B0%5D.style.display=spanslist%5B1%5D.style.display='block';clkTosmalls.textContent='收起%3C'%7Delse%7Bspanslist%5B0%5D.style.display=spanslist%5B1%5D.style.display='none';clkTosmalls.textContent='展开%3E'%7DdiffBox.style.width=clkTosmalls_switch?'10%25':'100%25';clkTosmalls_switch=!clkTosmalls_switch%7D;clkToclear.addEventListener('click',function()%7Bspanslist%5B0%5D.innerText=link1='';spanslist%5B1%5D.innerText=link2=''%7D);clkToblank.addEventListener('click',function()%7BopenedWindows.forEach(w=%3E%7Bif(!w.closed)w.close()%7D);openedWindows=%5B%5D;const%20w=window.screen.width;const%20h=window.screen.height/2;const%20ww=Math.floor(w/2)-10;%5Blink1,link2%5D.forEach((u,i)=%3E%7Bconst%20win=window.open(u,'_blank','width='+ww+',height='+h+',menubar=no,toolbar=no,location=no,status=no');win.moveTo(i*(ww+10),h);openedWindows.push(win)%7D)%7D);clkToclose.addEventListener('click',function()%7BopenedWindows.forEach(w=%3E%7Bif(!w.closed)w.close()%7D);openedWindows=%5B%5D%7D);changeIframeLinkStyle(links_des);changeIframeLinkStyle(links_mob);iframewindow_des.document.addEventListener('dragstart',e=%3Ee.preventDefault());iframewindow_mob.document.addEventListener('dragstart',e=%3Ee.preventDefault());document.addEventListener('contextmenu',handleOpenedWindows);iframewindow_des.document.addEventListener('contextmenu',handleOpenedWindows);iframewindow_mob.document.addEventListener('contextmenu',handleOpenedWindows);%7D)()">Link
            Compare</a>

        <a class="layui-btn layui-btn-primary layui-border-green layui-btn-radius"
            href="javascript:(function(){let uikit_link=document.createElement('link');uikit_link.rel='stylesheet';uikit_link.href='https://cdn.jsdelivr.net/npm/uikit@3.21.9/dist/css/uikit.min.css';let uikit_script=document.createElement('script');uikit_script.src='https://cdn.jsdelivr.net/npm/uikit@3.21.9/dist/js/uikit.min.js';uikit_script.defer=true;let head=document.head||document.getElementsByTagName('head')[0];head.appendChild(uikit_link);head.appendChild(uikit_script);const frame0=document.getElementById('iframe_0'),frame1=document.getElementById('iframe_1'),frame2=document.getElementById('iframe_2'),isCompareToUS=location.href.includes('html'||'mobile'),navbar_nav=document.querySelector('.navbar-nav'),htmlElement=`<div class='diff-output'><div style='padding: 5px 8px;'><button class='cyBtn uk-button uk-button-secondary'>收起到顶部</button><span style='margin: 0 6px;border-right: 1px solid #666;height: 12px;display: inline-block;'></span><button class='cyBtn uk-button uk-button-primary'>`+(isCompareToUS?'GC/US':'Desktop/Mobile')+`文本对比</button><button class='cyBtn uk-button uk-button-default'>Html/Txt文本对比</button><button class='cyBtn uk-button uk-button-secondary'>`+(isCompareToUS?'GC/US':'Desktop/Mobile')+`链接对比</button></div><div class='diff-title'><strong></strong><strong></strong></div><div class='diff-box'><div></div><div></div></div></div>`;let compareToUsBool=false;const script=document.createElement('script');script.src=`https://cdnjs.cloudflare.com/ajax/libs/jsdiff/5.0.0/diff.min.js`;document.head.appendChild(script);const style=document.createElement('style');style.textContent=`.diff-added{background-color:#b4fb8b;}.diff-removed{background-color:#fa92a3;}.diff-box{display:flex;justify-content:space-between;padding:0 10px;}.diff-box>div{width:48%;border:1px solid #ccc;font-size:14px;padding:10px;border-radius:8px;}.diff-output{width:100%;max-height:100vh;overflow:auto;position:fixed;top:0;background-color:#fff;padding:10px 0;border:1px solid #666;box-shadow:0 4px 8px rgba(0,0,0,0.2);z-index:1000;}.uk-button{margin-right:4px;border-radius:4px;font-size:12px;line-height:20px;padding:0 6px;}.uk-button:hover{transform:translateY(-2px);box-shadow:0 2px 4px rgba(0,0,0,0.1);transition:transform 0.2s ease,box-shadow 0.2s ease;}.uk-button-default{border:1px solid #333;}.uk-button-link{text-decoration:underline;}.diff-title{display:flex;justify-content:space-around;padding:6px 0;}.diff_linkbox{border:1px solid #d9d9d9;font-size:14px;padding:4px;overflow:auto;white-space:nowrap;box-sizing:border-box;border-radius:4px;}.diff_linkbox::-webkit-scrollbar{display:none;}.diff-con{border-radius:4px;padding:2px 8px;font-size:12px;vertical-align:text-top;}`;document.head.appendChild(style);document.body.insertAdjacentHTML('beforeend',htmlElement);let menuItem=`<li id='openTextCompareBtn' class='nav-item'><a class='nav-link'>Text Compare</a></li>`;navbar_nav.insertAdjacentHTML('beforeend',menuItem);const openTextCompareBtn=document.getElementById('openTextCompareBtn'),diffOutput=document.querySelector('.diff-output');openTextCompareBtn.onclick=()=>{diffOutput.style.display='block';};if(!frame2){document.querySelectorAll('.cyBtn')[2].disabled=true;compareToUsBool=true;}let diffCount1=0,diffCount2=0;const spansText=document.querySelectorAll('.diff-box div'),cyBtn=document.querySelectorAll('.cyBtn'),diffTitle=document.querySelectorAll('.diff-title strong'),desktopContainer=frame0.contentWindow.document.querySelector('.desktop-container'),mobileContainer=frame1.contentWindow.document.querySelector('.mobile-container'),usContainer=frame1.contentWindow.document.querySelector('.desktop-container'),tableContainer=frame0.contentWindow.document.querySelector('table'),txtContainer=frame2?.contentWindow.document.body,text_txtContainer=txtContainer?.textContent.replace(/\s+/g,' ').replace(/https:\/\/[^\s]+/g,'').replace(/-{2,}\s*/g,'').trim(),text_htmlContainer=tableContainer.textContent.replace(/\s+/g,' ').replace(/\|\s*/g,'').trim();function getAllLinks(container){const links=container.querySelectorAll('a');const linkAddresses=Array.from(links).map(link=>link.href);return linkAddresses;}const link_desktopContainer=getAllLinks(desktopContainer),link_mobileContainer=isCompareToUS?getAllLinks(usContainer):getAllLinks(mobileContainer);function compareTexts(text1,text2){let diff=Diff.diffWords(text1,text2);const diff_text1=diff.map(function(part){const color=part.removed?'diff-removed':'';if((!part.removed&&!part.added)||part.removed){return`<span class='`+color+`'>`+part.value.replace(/\n/g,'<br>')+`</span>`;}}).join(''),diff_text2=diff.map(function(part){const color=part.added?'diff-added':'';if((!part.removed&&!part.added)||part.added){return`<span class='`+color+`'>`+part.value.replace(/\n/g,'<br>')+`</span>`;}}).join('');spansText[0].insertAdjacentHTML('beforeend',diff_text1);spansText[0].insertAdjacentHTML('beforeend','<br>');spansText[1].insertAdjacentHTML('beforeend',diff_text2);spansText[1].insertAdjacentHTML('beforeend','<br>');}function compareLinks(link1,link2){let diff;if(compareToUsBool){diff=Diff.diffWords(link1,link2);}else{diff=Diff.diffLines(link1,link2);}const diff_link1=diff.map(function(part){diffCount1=part.removed?diffCount1+1:diffCount1;const color=part.removed?'diff-removed':'';if((!part.removed&&!part.added)||part.removed){return`<span class='`+color+`'>`+part.value.replace(/\n/g,'<br>')+`</span>`;}}).join(''),diff_link2=diff.map(function(part){diffCount2=part.added?diffCount2+1:diffCount2;const color=part.added?'diff-added':'';if((!part.removed&&!part.added)||part.added){return`<span class='`+color+`'>`+part.value.replace(/\n/g,'<br>')+`</span>`;}}).join('');spansText[0].insertAdjacentHTML('beforeend',`<div class='diff_linkbox'>`+diff_link1+`<div>`);spansText[1].insertAdjacentHTML('beforeend',`<div class='diff_linkbox'>`+diff_link2+`<div>`);}cyBtn[1].addEventListener('click',function(){spansText[0].innerHTML='';spansText[1].innerHTML='';const des_element_arr=desktopContainer.querySelectorAll('p,h1,h2,h3,h4,h5,h6,a'),mob_element_arr=mobileContainer.querySelectorAll('p,h1,h2,h3,h4,h5,h6,a');let element_arr_text=[];des_element_arr.forEach((o,i)=>{element_arr_text.push({des:o.textContent.replace(/\s+/g,' ').trim(),mob:mob_element_arr[i].textContent.replace(/\s+/g,' ').trim()})});console.log('🚀 ~ element_arr_text:',element_arr_text);element_arr_text.forEach(o=>{compareTexts(o.des,o.mob)});diffTitle[0].innerHTML=`${isCompareToUS?'GC文本':'Desktop文本'} <span class='diff-removed diff-con'>delete</span>`;diffTitle[1].innerHTML=`${isCompareToUS?'US文本':'Mobile文本'} <span class='diff-added diff-con'>add</span>`});cyBtn[2].addEventListener('click',function(){spansText[0].innerHTML='';spansText[1].innerHTML='';compareTexts(text_htmlContainer,text_txtContainer);diffTitle[0].innerHTML=`HTML文本 <span class='diff-removed diff-con'>delete</span>`;diffTitle[1].innerHTML=`TXT文本 <span class='diff-added diff-con'>add</span>`});cyBtn[3].addEventListener('click',function(){diffCount1=diffCount2=0;spansText[0].innerHTML='';spansText[1].innerHTML='';const linkcountArr=link_desktopContainer.length>=link_mobileContainer.length?link_desktopContainer:link_mobileContainer;linkcountArr.forEach((_,index)=>{compareLinks(link_desktopContainer[index]||'N/A',link_mobileContainer[index]||'N/A')});diffTitle[0].innerHTML=`${isCompareToUS?'GC链接':'Desktop链接'} <span class='diff-removed diff-con'>diff: ${diffCount1}</span>`;diffTitle[1].innerHTML=`${isCompareToUS?'US链接':'Mobile链接'} <span class='diff-added diff-con'>diff: ${diffCount2}</span>`});cyBtn[0].addEventListener('click',function(){diffOutput.style.display='none';});})();">Text
            Compare</a>

        <a class="layui-btn layui-btn-primary layui-border-green layui-btn-radius"
            href="javascript:(function(){let uikit_link=document.createElement('link');uikit_link.rel='stylesheet',uikit_link.href='https://cdn.jsdelivr.net/npm/uikit@3.21.9/dist/css/uikit.min.css';let uikit_script=document.createElement('script');uikit_script.src='https://cdn.jsdelivr.net/npm/uikit@3.21.9/dist/js/uikit.min.js',uikit_script.defer=!0;let ukicon_script=document.createElement('script');ukicon_script.src='https://cdn.jsdelivr.net/npm/uikit@3.21.9/dist/js/uikit-icons.min.js',ukicon_script.defer=!0;let head=document.head||document.getElementsByTagName('head')[0];head.appendChild(uikit_link),head.appendChild(uikit_script),head.appendChild(ukicon_script);const style=document.createElement('style');style.textContent=`
            .diff-box{display:flex;justify-content:space-between;padding:0 10px}.diff-case{width:48%;border:1px solid #999;font-size:14px;padding:10px}.diff-output{width:100%;max-height:100vh;overflow:auto;position:fixed;top:0;background-color:rgba(255,250,254,0.98);padding:10px 8px;border:1px solid #666;box-shadow:0 4px 8px rgba(0,0,0,0.2)}.uk-button{margin-right:4px;border-radius:4px;font-size:12px;line-height:20px;padding:0 6px}.uk-button-default{border:1px solid #333}.uk-button-link{text-decoration:underline}#modal-onecheck dt,#modal-tool dt{padding:10px 0 6px!important;margin:10px 0 0!important}#modal-onecheck dd,#modal-tool dd{font-size:14px!important}
        `,document.head.appendChild(style);const htmlElement=`
          <div class='diff-output'><div><button class='uk-button uk-button-secondary pickup'>收起</button><button class='uk-button uk-button-secondary clear'>清除所有高亮显示</button><span style='color: #cdd5d5;padding: 0 8px;'>|</span><button class='uk-button uk-button-default spaces'>显示空格</button><button class='uk-button uk-button-default words'>英文高亮</button><button class='uk-button uk-button-default footnotes'>角标高亮</button><span style='color: #cdd5d5;padding: 0 8px;'>|</span><button class='uk-button uk-button-primary onecheck'uk-toggle='target: #modal-onecheck'>一键检测</button><button class='uk-button uk-button-default tool'uk-toggle='target: #modal-tool'>工具说明</button></div><div id='modal-tool'uk-modal><div class='uk-modal-dialog uk-modal-body uk-overflow-auto uk-modal-container'style='width:50%'><h3 class='uk-modal-title uk-heading-divider'>ic平台一键Check工具说明</h3><dl class='uk-description-list uk-description-list-divider'><dt><button class='uk-button uk-button-secondary'>清除所有高亮显示</button></dt><dd>清除页面上所有的高亮样式，包括显示空格、英文高亮以及角标高亮。</dd><dt><button class='uk-button uk-button-default'>显示空格</button></dt><dd>显示页面中所有的空格，可以和英文高亮配合使用，方便检查英文前后是否有遗漏空格的问题。注：空格高亮会占用宽度导致文字布局发生变化，请忽略。</dd><dt><button class='uk-button uk-button-default'>英文高亮</button></dt><dd>将页面中的英文用高亮颜色显示，可以和显示空格配合使用，检查英文关键字是否有断行，以及前后是否有空格。</dd><dt><button class='uk-button uk-button-default'>角标高亮</button></dt><dd>将页面中的所有角标以红色高亮显示，鼠标浮动上去即可显示对应的legal条款内容。</dd><dt><button class='uk-button uk-button-primary'>一键检测</button></dt><dd><div>*检查电话号码是否本地化正确</div><div>*检查价格单位是否本地化正确</div><div>*检查所有图片地址前缀是否一致</div><div>*检查每个链接地址是否都有本地化（仅供参考）</div><div>*检查是否有未正确转换的链接变量</div><div>*检查链接地址cid是否正确，是否有多个cid或者缺少cid的情况</div><div>*待开发......</div></dd></dl><p class='uk-text-right'><button class='uk-button uk-button-primary uk-modal-close'type='button'>我已知晓</button></p></div></div><div id='modal-onecheck'uk-modal><div class='uk-modal-dialog uk-modal-body uk-overflow-auto uk-modal-container'style='width:50%'><div class='uk-modal-title uk-heading-divider'>一键检测</div><dl class='uk-description-list uk-description-list-divider'id='onecheckList'><dt><span>检查电话号码是否本地化正确：</span><span class='signIcon'ratio='1'></span></dt><dd></dd><dt><span>检查价格单位是否本地化正确：</span><span class='signIcon'ratio='1'></span></dt><dd></dd><dt><span>检查所有图片地址前缀是否一致：</span><span class='signIcon'ratio='1'></span></dt><dd></dd><dt><span>检查每个链接地址是否都有本地化：</span><span class='signIcon'ratio='1'></span></dt><dd></dd><dt><span>检查是否有未正确转换的链接变量：</span><span class='signIcon'ratio='1'></span></dt><dd></dd><dt><span>检查链接地址cid是否正确，是否有多个cid或者缺少cid的情况：</span><span class='signIcon'ratio='1'></span><dd></dd></dl><p class='uk-text-right'><button class='uk-button uk-button-primary uk-modal-close'type='button'>close</button></p></div></div></div>
    `;document.body.insertAdjacentHTML('beforeend',htmlElement);let iframewindow_des=document.getElementById('iframe_0').contentWindow,iframewindow_mob=document.getElementById('iframe_1').contentWindow;const diffOutput=document.querySelector('.diff-output'),pickupBtn=document.querySelector('button.pickup'),clearBtn=document.querySelector('button.clear'),spacesBtn=document.querySelector('button.spaces'),wordsBtn=document.querySelector('button.words'),footnotesBtn=document.querySelector('button.footnotes'),onecheckBtn=document.querySelector('button.onecheck');let spacesValue=!1,wordsValue=!1,footnotesValue=!1,onecheckValue=!1;function highlightSpaces(t){if(t.nodeType===Node.TEXT_NODE){let e=t.parentNode,n=t.textContent.replace(/\u00A0/g,' '),i=n.split(/(\S\s+ | \s+\S)/);i.forEach(n=>{if(/\S\s+\S/.test(n)){let i=n.split(/(\s)/);i.forEach(n=>{if(' '===n){let i=document.createElement('span');i.className='highlight-space',e.insertBefore(i,t)}else e.insertBefore(document.createTextNode(n),t)})}else e.insertBefore(document.createTextNode(n),t)}),e.removeChild(t)}else t.nodeType===Node.ELEMENT_NODE&&'SCRIPT'!==t.tagName&&'STYLE'!==t.tagName&&Array.from(t.childNodes).forEach(highlightSpaces)}function colorizeEnglishWords(t){if(t.nodeType===Node.TEXT_NODE){let e=t.parentNode,n=t.textContent,i=n.replace(/(\b[A-Za-z]+\b)/g,t=>`<span class='highlight-text'>${t}</span>`),o=document.createElement('div');for(o.innerHTML=i;o.firstChild;)e.insertBefore(o.firstChild,t);e.removeChild(t)}else t.nodeType===Node.ELEMENT_NODE&&'SCRIPT'!==t.tagName&&'STYLE'!==t.tagName&&Array.from(t.childNodes).forEach(colorizeEnglishWords)}function highlightFootnotes(t){let e=t.querySelectorAll('sup'),n=t.querySelector('.shared-footer'),i=n.getElementsByTagName('span');function o(t){if(t.nodeType===Node.TEXT_NODE){let e=t.parentNode,n=t.textContent,i=n.replace(/\*/g,t=>`<span class='sup_style sup_star'>${t}</span>`),d=document.createElement('div');for(d.innerHTML=i;d.firstChild;)e.insertBefore(d.firstChild,t);e.removeChild(t)}else t.nodeType===Node.ELEMENT_NODE&&'SCRIPT'!==t.tagName&&'STYLE'!==t.tagName&&Array.from(t.childNodes).forEach(o)}o(t.querySelector('.desktop-container')),o(t.querySelector('.mobile-container')),Array.from(e).forEach(t=>{t.classList.add('sup_style')});let d=[...Array.from(t.querySelectorAll('.sup_star')),...Array.from(e)];Array.from(i).forEach(t=>{d.forEach(e=>{if(t.textContent.trim()===e.textContent.trim()+'.'||'*'===t.textContent.trim()&&'*'===e.textContent.trim()){let n=t.parentElement,i=document.createElement('div');i.className='tooltip',e.parentNode.insertBefore(i,e);let o=document.createElement('div');o.className='tooltiptext',o.textContent=n.textContent,i.appendChild(e),i.appendChild(o)}})})}function oneButtonToCheck(t){let e=t.querySelector('.shared-footer'),n=document.querySelectorAll('#onecheckList .signIcon'),i=document.querySelectorAll('#onecheckList dd'),o={hk:{Tel:'800-908-988',price:'HK$',cid:'cid=CDM-HK-DM-C9999-M9999',href:'/hk'},hken:{Tel:'800-908-988',price:'HK$',cid:'cid=CDM-HK-DM-C9999-M9999',href:'/hk/en'},mo:{Tel:'',price:'MOP$',cid:'cid=CDM-MO-DM-C9999-M9999',href:'/mo'},cn:{Tel:'400-666-8800',price:'RMB',cid:'cid=CDM-CN-DM-C9999-M9999',href:'.cn'},tw:{Tel:'0800-020-021',price:'NT$',cid:'cid=CDM-TW-DM-C9999-M9999',href:'/tw'}},d=window.location.href,s=function t(e,n){for(let i of n)if(e.includes(i))return i.replace(/[./]/g,'');return null}(d,['/hk','/hk/en','/cn','.cn','/tw','/mo']);console.log('\uD83D\uDE80 ~ 当前语言 ~ currentArea:',s);let l=t.textContent.replace(/\s+/g,' ').trim(),a=e.textContent.replace(/\s+/g,' ').trim();function c(t,e,o,d){t?(n[e].classList.add('uk-text-success'),n[e].setAttribute('uk-icon','icon: check'),i[e].classList.add('uk-text-success'),i[e].innerHTML=`========= 当前语言：${s}，${o}`):(n[e].classList.add('uk-text-warning'),n[e].setAttribute('uk-icon','icon: warning'),i[e].classList.add('uk-text-warning'),i[e].innerHTML=`========= 当前语言：${s}，${d}`)}c(a.includes(o[s].Tel),0,`电话号码：${o[s].Tel}。`,`没有找到对应的电话号码。`);let r=[],u=['HK$','MOP$','RMB','NT$'];for(let p=0;p<u.length;p++)u[p]===o[s].price&&u.splice(p,1);u.forEach(t=>{l.includes(t)&&r.push(t)}),c(0==r.length,1,`价格单位：${o[s].price}。`,`出现其他地区价格单位${r.join('，')}。`);let h=t.querySelectorAll('img'),f=[],k=null;h.forEach(t=>{let e=t.src,n=e.match(/http.*\/i\//);if(n&&n[0]){let i=n[0];null===k?k=i:k!==i&&f.push(e)}}),c(0==f.length,2,`图片前缀地址一致：${k}。`,`出现异常的图片地址，请检查<br>${f.join('<br>')}。`);let b=['hk','cn','tw','mo','HK','CN','TW','MO'],g=[];t.querySelectorAll('a').forEach(t=>{let e=t.getAttribute('href'),n=b.some(t=>e.includes(t));n||e.includes('${')||g.push(e)}),c(0==g.length,3,`链接地址都以本地化。`,`可能有未本地化的链接，请检查<br>${g.join('<br>')}。`);let m=[];t.querySelectorAll('a').forEach(t=>{let e=t.getAttribute('href');e.includes('${')&&m.push(e)}),c(0==m.length,4,`链接变量都已转化为地址。`,`有未转化的链接变量，请检查<br>${m.join('<br>')}。`),o[s].cid;let y=[],$=[];t.querySelectorAll('a').forEach(t=>{let e=t.getAttribute('href');e.includes('cid')||y.push(e);let n=[...e.matchAll(/cid/g)];n.length>1&&$.push(e)}),0==y.length&&0==$.length?(n[5].classList.add('uk-text-success'),n[5].setAttribute('uk-icon','icon: check'),i[5].classList.add('uk-text-success'),i[5].innerHTML=`========= 当前语言：${s}，所有链接都有唯一一个cid。`):y.length>0&&0==$.length?(n[5].classList.add('uk-text-warning'),n[5].setAttribute('uk-icon','icon: warning'),i[5].classList.add('uk-text-warning'),i[5].innerHTML=`========= 当前语言：${s}，下列链接可能没有cid，请检查<br>${y.join('<br>')}。`):$.length>0&&0==y.length?(n[5].classList.add('uk-text-warning'),n[5].setAttribute('uk-icon','icon: warning'),i[5].classList.add('uk-text-warning'),i[5].innerHTML=`========= 当前语言：${s}，下列链接可能有多个cid，请检查<br>${$.join('<br>')}。`):(n[5].classList.add('uk-text-warning'),n[5].setAttribute('uk-icon','icon: warning'),i[5].classList.add('uk-text-warning'),i[5].innerHTML=`========= 当前语言：${s}，下列链接含有多个cid，请检查<br>${$.join('<br>')}。下列链接可能没有cid，请检查${y.join('<br>')}`)}diffOutput.lang=document.getElementById('modal-onecheck').lang=document.getElementById('modal-tool').lang='zh-CN';const highlightstyle=`
                .highlight-space{display:inline-block;width:0.5em;height:1em;background-color:#00c180;vertical-align:bottom}.highlight-text{color:#ff8892}.sup_style{color:red;font-weight:700;font-size:35px;border:2px solid #000!important}.tooltip{position:relative;display:inline-block;cursor:pointer}.tooltip .tooltiptext{display:none;width:220px;height:160px;overflow:auto;font-size:12px;line-height:14px;background-color:black;color:#fff;border-radius:5px;padding:5px;position:absolute;z-index:1;bottom:85%;left:50%;margin-left:-110px}.tooltip:hover .tooltiptext{display:inline-block}
                    `;function createHighlightstyle(){let t=iframewindow_des.document.createElement('style'),e=iframewindow_mob.document.createElement('style');t.innerHTML=e.innerHTML=highlightstyle,iframewindow_des.document.head.appendChild(t),iframewindow_mob.document.head.appendChild(e)}function handleClearStyle(){spacesBtn.disabled=wordsBtn.disabled=footnotesBtn.disabled=!0,iframewindow_des.location.reload(),iframewindow_mob.location.reload(),document.getElementById('iframe_1').onload=function(){UIkit.notification({message:`<span uk-icon='icon: check'></span> 样式已清除`,status:'primary'}),createHighlightstyle(),spacesBtn.disabled=wordsBtn.disabled=footnotesBtn.disabled=!1},spacesValue=wordsValue=footnotesValue=!1}function handleVisbleSpaces(){if(!spacesValue){if(wordsValue){UIkit.notification({message:`<span uk-icon='icon: warning'></span> 若要英文高亮和显示空格同时显示，须先点击显示空格`,status:'warning'});return}highlightSpaces(iframewindow_des.document.body),highlightSpaces(iframewindow_mob.document.body),spacesValue=!0,spacesBtn.disabled=!0}}function handleHighlightWords(){!wordsValue&&(colorizeEnglishWords(iframewindow_des.document.body),colorizeEnglishWords(iframewindow_mob.document.body),wordsValue=!0,wordsBtn.disabled=!0)}function handleVisbleFootnotes(){!footnotesValue&&(highlightFootnotes(iframewindow_des.document.body),highlightFootnotes(iframewindow_mob.document.body),footnotesValue=!0,footnotesBtn.disabled=!0)}function handleOneCheck(){UIkit.notification({message:`<span uk-icon='icon: check'></span> 一键检测完成`,status:'success'}),UIkit.offcanvas(document.getElementById('offcanvas-flip')).show(),!onecheckValue&&(oneButtonToCheck(iframewindow_des.document.body),onecheckValue=!0)}createHighlightstyle(),pickupBtn.onclick=function(){'展开'===pickupBtn.innerText?(diffOutput.style.height='auto',diffOutput.style.width='100%',document.querySelectorAll('button').forEach(t=>{t.style.visibility='visible'}),pickupBtn.innerText='收起'):(diffOutput.style.height='50px',diffOutput.style.width='60px',diffOutput.style.overflow='hidden',document.querySelectorAll('button').forEach(t=>{'收起'!==t.innerText&&(t.style.visibility='hidden')}),pickupBtn.innerText='展开')},clearBtn.onclick=handleClearStyle,spacesBtn.onclick=handleVisbleSpaces,wordsBtn.onclick=handleHighlightWords,footnotesBtn.onclick=handleVisbleFootnotes,onecheckBtn.onclick=handleOneCheck;})()">
            Quick Check</a>

        <a class="layui-btn layui-btn-primary layui-border-green layui-btn-radius"
            href="javascript:(function(){let uikit_link=document.createElement('link');uikit_link.rel='stylesheet';uikit_link.href='https://cdn.jsdelivr.net/npm/uikit@3.21.9/dist/css/uikit.min.css';let head=document.head||document.getElementsByTagName('head')[0];head.appendChild(uikit_link);let iframewindow_des=document.getElementById('iframe_0').contentWindow;let iframewindow_mob=document.getElementById('iframe_1').contentWindow;const links_des=iframewindow_des.document.querySelectorAll('a');const links_mob=iframewindow_mob.document.querySelectorAll('a');const htmlConstract=`<div class='diff-output'><div style='padding: 5px 8px;'><button class='copyUrl uk-button uk-button-secondary'>复制并添加到URL队列</button><button class='drag uk-button uk-button-primary' id='draggable'>拖动我</button><button class='uk-button uk-button-default diffBtn1'>清除左边上一条url</button><button class='uk-button uk-button-default diffBtn2'>清除右边上一条url</button><button class='openUrl uk-button uk-button-secondary' disabled>点击我！</button><span class='link_count'></span></div><div class='diff-box'><div id='diffcase1'></div><div id='diffcase2'></div></div></div>`;document.body.insertAdjacentHTML('afterbegin',htmlConstract);const style=document.createElement('style');style.textContent=`.uk-button{border-radius:4px;font-size:12px;line-height:20px;padding:0 6px;margin-right:4px;}.diff-output{z-index:1000;width:50%;max-height:350px;overflow:auto;background-color:rgba(255,250,254,0.98);padding:10px 0;border:1px solid #666;box-shadow:0 4px 8px rgba(0,0,0,0.2);position:absolute;}#draggable{cursor:move;}.diff-box{display:flex;padding:0 10px;}#diffcase1,#diffcase2{border:1px solid #999;font-size:12px;padding:0 4px;display:flex;flex-direction:column;overflow:auto;}#diffcase1 span,#diffcase2 span{border-bottom:1px solid #666;white-space:nowrap;height:20px;}%60;document.head.appendChild(style);const diffOutput=document.querySelector('.diff-output');let clickCount=0;let finalArr=[];const openUrl=document.querySelector('.openUrl');const link_count=document.querySelector('.link_count');draggable.onmousedown=function(event){let shiftX=event.clientX-diffOutput.getBoundingClientRect().left;let shiftY=event.clientY-diffOutput.getBoundingClientRect().top;function moveAt(pageX,pageY){diffOutput.style.left=pageX-shiftX+'px';diffOutput.style.top=pageY-shiftY+'px';}function onMouseMove(event){moveAt(event.pageX,event.pageY);}document.addEventListener('mousemove',onMouseMove);draggable.onmouseup=function(){document.removeEventListener('mousemove',onMouseMove);diffOutput.onmouseup=null;};};draggable.ondragstart=()=>false;openUrl.ondragstart=()=>false;const iframeStyle_des=iframewindow_des.document.createElement('style');const iframeStyle_mob=iframewindow_mob.document.createElement('style');const diffcase1=document.querySelector('#diffcase1');const diffcase2=document.querySelector('#diffcase2');const highlightStr=%60a.highlight{color:red!important;font-weight:bold!important;text-decoration:underline!important;background-color:yellow!important;padding:5px!important;border:2px solid black!important;}a.highlight_active{background:orange!important;}%60;iframeStyle_des.textContent=highlightStr;iframeStyle_mob.textContent=highlightStr;document.head.appendChild(style);iframewindow_des.document.head.appendChild(iframeStyle_des);iframewindow_mob.document.head.appendChild(iframeStyle_mob);function changeIframeLinkStyle(links,sign){links.forEach(link=>{link.classList.add('highlight');link.addEventListener('click',function(event){event.preventDefault();link.classList.add('highlight_active');addLinks(link,sign);diffOutput.scrollTop=diffOutput.scrollHeight;});});}changeIframeLinkStyle(links_des,'des');changeIframeLinkStyle(links_mob,'mob');function addLinks(link,sign){const spans=document.createElement('span');spans.innerText=link.href;if(sign==='des'){diffcase1.appendChild(spans);}else if(sign==='mob'){diffcase2.appendChild(spans);}}document.querySelector('.copyUrl').onclick=()=>{clickCount=0;finalArr=[];openUrl.disabled=false;const spanTexts1=Array.from(diffcase1.querySelectorAll('span')).map(s=>s.innerText);const spanTexts2=Array.from(diffcase2.querySelectorAll('span')).map(s=>s.innerText);spanTexts1.forEach((o,i)=>{finalArr.push(spanTexts2[i],o);});if(spanTexts1.length!==spanTexts2.length){alert('两边URL数量不一致！');}const finalStr=finalArr.join('\n');link_count.innerText=%60Link数量：${finalArr.length}%60;console.log(finalStr);upDateClipboard(finalStr);};function upDateClipboard(finalText){navigator.clipboard.writeText(finalText).then(function(){alert('复制成功,URL已生成');}).catch(function(err){alert('复制失败: '+err);});}document.querySelector('.diffBtn1').onclick=()=>{diffcase1.removeChild(diffcase1.lastElementChild);};document.querySelector('.diffBtn2').onclick=()=>{diffcase2.removeChild(diffcase2.lastElementChild);};function blob_fun(click_count){const blob_htmlContent=%60<html><head><title>${(click_count/2)+1}</title></head><body style='text-align:center;margin-top:30vh;'><h1>Url</h1><p>${finalArr[click_count]}</p><p>${finalArr[click_count+1]}</p></body></html>%60;const blob=new Blob([blob_htmlContent],{type:'text/html'});const blob_url=URL.createObjectURL(blob);return blob_url;};openUrl.onclick=()=>{if(clickCount<finalArr.length){finalArr.forEach(o=>{if(clickCount%2===0){window.open(blob_fun(clickCount),'_blank');}window.open(o,'_blank');clickCount++;link_count.innerText=%60URL队列Link数量：${finalArr.length-clickCount}%60;if(finalArr.length-clickCount==0){openUrl.disabled=true;}});}};iframewindow_des.document.addEventListener('dragstart',(event)=>{event.preventDefault();});iframewindow_mob.document.addEventListener('dragstart',(event)=>{event.preventDefault();});})();">
            Open Url</a>

        </div>
        <hr>
        <div class="a-box">
            <a class="layui-btn layui-btn-primary layui-border-orange layui-btn-radius"
            href="javascript:(function(){let iframewindow_des=document.getElementById('iframe_0').contentWindow,iframewindow_mob=document.getElementById('iframe_1').contentWindow,desktopContainer=iframewindow_des.document.querySelector('.desktop-container'),mobileContainer=iframewindow_mob.document.querySelector('.mobile-container'),usContainer=iframewindow_mob.document.querySelector('.desktop-container'),tableContainer=iframewindow_des.document.querySelector('table'),text_desktopContainer=desktopContainer.textContent.replace(/\s+/g,' ').trim(),text_mobileContainer=mobileContainer.textContent.replace(/\s+/g,' ').trim(),text_htmlContainer=tableContainer.textContent.replace(/\s+/g,' ').trim(),navbar_nav=document.querySelector('.navbar-nav'),style=document.createElement('style');style.textContent=`/* 弹窗按钮 */#openModalBtn{cursor:pointer;}/* 遮罩层 */.tool_overlay{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,0.5);justify-content:center;align-items:center;z-index:1000;}/* 弹窗内容 */.tool_modal{background-color:#fff;padding:30px;border-radius:8px;box-shadow:0 4px 10px rgba(0,0,0,0.1);text-align:center;font-size:12px;max-width:90vw;overflow:auto;height:100vh;}.tool_modal b{line-height:30px;font-size:14px;}/* 弹窗关闭按钮 */#closeModalBtn{margin-left:10px;padding:10px 20px;font-size:12px;background-color:#e74c3c;color:white;border:none;border-radius:5px;cursor:pointer;}#closeModalBtn:hover{background-color:#c0392b;}.tool_table{width:100%;border-collapse:collapse;}.tool_table table,.tool_table th,.tool_table td{border:1px solid black;}.tool_table th,.tool_table td{padding:8px;text-align:left;}.tool_table th{background-color:#f2f2f2;}colgroup col:nth-child(2),colgroup col:nth-child(4){background-color:#e6f7ff;}`;document.head.appendChild(style);let des_images=desktopContainer.querySelectorAll('img'),mob_images=location.href.includes('html'|'mobile')?usContainer.querySelectorAll('img'):mobileContainer.querySelectorAll('img'),tableData;if(des_images.length>=mob_images.length){tableData=Array.from(des_images).map((o,i)=>({des_alt:o.alt,des_src:o.src,mob_alt:mob_images[i].alt||'',mob_src:mob_images[i].src||''}));}else{tableData=Array.from(mob_images).map((o,i)=>({des_alt:des_images[i].alt||'',des_src:des_images[i].src||'',mob_alt:o.alt,mob_src:o.src}));}let htmlContent=`<div id='tool_overlay' class='tool_overlay'><div class='tool_modal'><b>ALT compare</b><table class='tool_table'><colgroup><col style='background-color: #f9f9f9;'><col><col style='background-color: #f9f9f9;'><col></colgroup><thead><tr><th>GC/Desktop</th><th>PIC</th><th>US/Mobile</th><th>PIC</th></tr></thead><tbody>${tableData.map(o=>`<tr><td>${o.des_alt}</td><td><img src=${o.des_src} style='width:100px;'/></td><td>${o.mob_alt}</td><td><img src=${o.mob_src} style='width:100px;'/></td></tr>`).join('')}</tbody></table></div></div>`;let lis=`<li id='openModalBtn' class='nav-item'><a class='nav-link'>查看Alt列表</a></li>`;document.body.insertAdjacentHTML('afterbegin',htmlContent);navbar_nav.insertAdjacentHTML('beforeend',lis);const openModalBtn=document.getElementById('openModalBtn'),closeModalBtn=document.getElementById('closeModalBtn'),overlay=document.getElementById('tool_overlay');openModalBtn.onclick=()=>{overlay.style.display='flex';};overlay.onclick=(event)=>{if(event.target===overlay){overlay.style.display='none';};};})();
">
            Alt Check</a>
            
            <a class="layui-btn layui-btn-primary layui-border-orange layui-btn-radius"
            href="javascript:(function(){let iframewindow_des=document.getElementById('iframe_0').contentWindow,iframewindow_mob=document.getElementById('iframe_1').contentWindow,desktopContainer=iframewindow_des.document.querySelector('.desktop-container'),mobileContainer=iframewindow_mob.document.querySelector('.mobile-container'),usContainer=iframewindow_mob.document.querySelector('.desktop-container'),footerContainer=iframewindow_des.document.querySelector('.shared-footer'),footerUSContainer=iframewindow_mob.document.querySelector('.shared-footer'),navbar_nav=document.querySelector('.navbar-nav'),style=document.createElement('style');style.textContent=`/* 弹窗按钮 */#openLinkBtn{cursor:pointer;}/* 遮罩层 */.tool_overlay{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,0.5);justify-content:center;align-items:center;z-index:1000;}/* 弹窗内容 */.tool_modal{background-color:#fff;padding:30px;border-radius:8px;box-shadow:0 4px 10px rgba(0,0,0,0.1);text-align:center;font-size:12px;max-width:90vw;overflow:auto;height:100vh;}.tool_modal b{line-height:30px;font-size:14px;}.tool_table{width:100%;border-collapse:collapse;font-size:14px;}.tool_table table,.tool_table th,.tool_table td{border:1px solid black;}.tool_table th,.tool_table td{padding:8px;text-align:center;}.tool_table th{background-color:#ccc;}.tool_table tr:nth-child(2n){background-color:#eee;}a{text-decoration:none;}td img{width:100px;height:auto;}`;document.head.appendChild(style);const isCompareToUS=location.href.includes('html'||'mobile'),des_links=desktopContainer.querySelectorAll('a'),mob_links=isCompareToUS?usContainer.querySelectorAll('a'):mobileContainer.querySelectorAll('a'),foot_des_links=footerContainer.querySelectorAll('a'),foot_mob_links=isCompareToUS?footerUSContainer.querySelectorAll('a'):footerContainer.querySelectorAll('a');let tableData=[],forCount=des_links.length>=mob_links.length?des_links.length:mob_links.length,forCount_foot=foot_des_links.length>=foot_mob_links.length?foot_des_links.length:foot_mob_links.length;for(let i=0;i<forCount;i++){tableData.push({des_text:des_links[i]?.innerText||des_links[i]?.innerHTML||`<span style='color:#999'>N/A</span>`,des_link:des_links[i]?.href||'',mob_text:mob_links[i]?.innerText||mob_links[i]?.innerHTML||`<span style='color:#999'>N/A</span>`,mob_link:mob_links[i]?.href||''});}tableData.push({des_text:`<span style='color:#999;'>FOOTER</span>`,des_link:'',mob_text:`<span style='color:#999;'>FOOTER</span>`,mob_link:''});for(let i=0;i<forCount_foot;i++){tableData.push({des_text:foot_des_links[i]?.innerText||foot_des_links[i]?.innerHTML||`<span style='color:#999'>N/A</span>`,des_link:foot_des_links[i]?.href||'',mob_text:foot_mob_links[i]?.innerText||foot_mob_links[i]?.innerHTML||`<span style='color:#999'>N/A</span>`,mob_link:foot_mob_links[i]?.href||''});}let htmlContent=`<div id='tool_overlay' class='tool_overlay'><div class='tool_modal'><b>Link Check</b><table class='tool_table'><colgroup><col><col><col><col></colgroup><thead><tr><th>${isCompareToUS?'GC':'Desktop'}</th><th>Href</th><th>${isCompareToUS?'US':'Mobile'}</th><th>Href</th></tr></thead><tbody>${tableData.map(o=>`<tr><td>${o.des_text}</td><td><a href=${o.des_link}>${o.des_link}</a></td><td>${o.mob_text}</td><td><a href=${o.mob_link}>${o.mob_link}</a></td></tr>`).join('')}</tbody></table></div></div>`,lis=`<li id='openLinkBtn' class='nav-item'><a class='nav-link'>链接列表</a></li>`;document.body.insertAdjacentHTML('afterbegin',htmlContent);navbar_nav.insertAdjacentHTML('beforeend',lis);const openLinkBtn=document.getElementById('openLinkBtn'),overlay=document.getElementById('tool_overlay');openLinkBtn.onclick=()=>{overlay.style.display='flex';};overlay.onclick=(event)=>{if(event.target===overlay){overlay.style.display='none';};};})();
">
            Link Check</a>
            
            <a class="layui-btn layui-btn-primary layui-border-orange layui-btn-radius"
            href="javascript:(function(){let iframewindow_des = document.getElementById('iframe_0').contentWindow; let iframewindow_mob = document.getElementById('iframe_1').contentWindow; const navbar_nav = document.querySelector('.navbar-nav'); const url = window.location.href; const validLocales = ['/hk', '/hk/en', '/cn', '.cn', '/tw', '/mo']; const validLocalesData = { '/hk': 'HK', '/hk/en': 'HK', '/cn': 'CN', '.cn': 'CN', '/tw': 'TW', '/mo': 'MO', }; let localGC = ''; for (const locale of validLocales) { if (url.includes(locale)) { localGC = validLocalesData[locale]; break; } } console.log('🚀 ~ localGC:', localGC); const style = document.createElement('style'); style.textContent = ` #openCidBtn, #openLocalBtn, #openImgBtn { cursor: pointer; } .cid_overlay, .local_overlay, .img_overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.5); justify-content: center; align-items: center; z-index: 1000; } .cid_modal, .local_modal, .img_modal { background-color: #fff; padding: 30px; border-radius: 8px; box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1); text-align: left; font-size: 14px; max-width: 90vw; max-height: 90vh; overflow: auto; } .img_modal { max-width: 95vw; } .cid_result { margin: 10px 0; padding: 10px; border-radius: 4px; } .cid_error, .local_error { background-color: #ffe6e6; color: #ff0000; } .cid_success, .local_success { background-color: #e6ffe6; color: #008000; } .cid_link, .local_link, .locale_link { background: white; padding: 10px; margin: 5px 0; border-radius: 4px; font-size: 12px; word-break: break-all; } .img_preview { max-width: 90px; max-height: 90px; object-fit: contain; } .img_preview_container { width: 100px; height: 100px; display: flex; justify-content: center; align-items: center; background: #e4e7eb; border-radius: 4px; border: 1px solid #eee; } .img_compare_container { display: flex; gap: 20px; justify-content: space-between; } .img_column { flex: 1; min-width: 45%; } .img_rows { display: flex; flex-direction: column; gap: 15px; } .img_row_pair { display: flex; gap: 20px; margin-bottom: 10px; } .img_item { flex: 1; padding: 12px; background: #f5f5f5; border-radius: 4px; } .img_content { display: flex; gap: 15px; margin-top: 8px; } .img_info { flex: 1; font-size: 12px; line-height: 1.6; font-weight: 700; } .img_info_row { margin-bottom: 4px; line-height: 1.4; } .img_info_label { color: #666; display: inline-block; } .img_info_value { color: #333; word-break: break-all; } .img_src { color: #0066cc; text-decoration: none; font-size: 11px; word-break: break-all; } .img_src:hover { text-decoration: underline; } .img_src_container { margin-top: 10px; background: #f5f5f5; word-break: break-all; font-size: 11px; } .img_summary { margin-top: 20px; padding: 15px; background-color: #f5f5f5; border-radius: 4px; } .local_result { padding: 15px; } .local_stats { margin-bottom: 30px; } .locale_stat { background: #f8f8f8; border-radius: 8px; padding: 15px; margin-bottom: 15px; } .locale_header { font-weight: bold; color: #333; margin-bottom: 10px; padding-bottom: 5px; border-bottom: 1px solid #eee; } .local_section { padding: 15px; border-radius: 8px; } .local_success_message { color: #008000; text-align: center; padding: 10px; } .cid_value { color: #ff6b6b; font-family: monospace; margin-top: 4px; font-size: 12px; } `; document.head.appendChild(style); const isCompareToUS = location.href.includes('html' || 'mobile'); const leftLabel = isCompareToUS ? 'GC' : 'Desktop'; const rightLabel = isCompareToUS ? 'US' : 'Mobile'; function checkCID() { const allLinks = iframewindow_des.document.querySelectorAll('a'); const linksWithoutCID = []; let hasCIDIssue = false; allLinks.forEach((link) => { const href = link.getAttribute('href'); if ( href && !href.includes('javascript:') && !href.startsWith('#') && !href.includes('?cid') && !href.includes('&cid') ) { linksWithoutCID.push({ href: href, text: link.textContent.trim(), }); hasCIDIssue = true; } }); let resultHTML = ''; if (hasCIDIssue) { resultHTML = ` <div class='cid_result cid_error'> <h3>发现 ${linksWithoutCID.length} 个链接缺少CID参数：</h3> ${linksWithoutCID .map( (link) => ` <div class='cid_link'> 链接文本: ${link.text}<br> 链接地址: ${link.href} </div> ` ) .join('<hr>')} </div> `; } else { resultHTML = ` <div class='cid_result cid_success'> <h3>检查完成！所有链接都包含CID参数。</h3> </div> `; } document.querySelector('.cid_modal').innerHTML = resultHTML; } function checkLocalization() { const allLinks = iframewindow_des.document.querySelectorAll('a'); const nonLocalizedLinks = []; const nonLocalizedCids = []; const localizedLinks = Object.fromEntries( ['hk', 'hk/en', 'mo', 'cn', 'tw'].map((key) => [key, []]) ); allLinks.forEach((link) => { const href = link.getAttribute('href'); if (!href || href.includes('javascript:') || href.startsWith('#')) return; const linkInfo = { href, text: link.textContent.trim(), }; const cidMatch = href.match(/cid=CDM-([A-Z]+)-DM-C\d+-M\d+/); if (cidMatch && !href.includes(localGC)) { nonLocalizedCids.push({ ...linkInfo, cid: cidMatch[0] }); } const hrefWithoutCid = href.replace(/cid=CDM-[A-Z]+-DM-C\d+-M\d+/g, ''); const foundLocale = Object.keys(localizedLinks).find((locale) => hrefWithoutCid.toLowerCase().includes(locale) ); if (foundLocale) { localizedLinks[foundLocale].push(linkInfo); } else { nonLocalizedLinks.push(linkInfo); } }); const localeStats = Object.entries(localizedLinks) .map( ([locale, links]) => ` <div class='locale_stat'> <div class='locale_header'>${locale.toUpperCase()}: ${ links.length }个链接</div> ${links .map( (link) => ` <div class='locale_link'> <div>链接文本: ${link.text}</div> <div>链接地址: ${link.href}</div> </div> ` ) .join('')} </div> ` ) .join(''); let resultHTML = ` <div class='local_result'> <div class='local_stats'> <h3>链接本地化标识统计：</h3> ${localeStats} </div> ${ nonLocalizedCids.length > 0 ? ` <div class='local_section local_error'> <h3>未本地化的CID参数 (${nonLocalizedCids.length}个)：</h3> ${nonLocalizedCids .map( (link) => ` <div class='local_link'> <div>链接文本: ${link.text}</div> <div>链接地址: ${link.href}</div> <div class='cid_value'>CID参数: ${link.cid}</div> </div> ` ) .join('')} </div> ` : '' } <div class='local_section ${ nonLocalizedLinks.length > 0 ? 'local_error' : 'local_success' }'> <h3>未本地化的链接 (${nonLocalizedLinks.length}个)：</h3> ${ nonLocalizedLinks.length > 0 ? nonLocalizedLinks .map( (link) => ` <div class='local_link'> <div>链接文本: ${link.text}</div> <div>链接地址: ${link.href}</div> </div> ` ) .join('') : `<div class='local_success_message'>所有链接都已本地化！</div>` } </div> </div> `; document.querySelector('.local_modal').innerHTML = resultHTML; } function checkImages() { const desktopImages = iframewindow_des.document.querySelectorAll('img'); const mobileImages = iframewindow_mob.document.querySelectorAll('img'); const maxLength = Math.max(desktopImages.length, mobileImages.length); let rowPairs = []; for (let i = 0; i < maxLength; i++) { const desktop = desktopImages[i] || {}; const mobile = mobileImages[i] || {}; rowPairs.push({ desktop: { src: desktop.getAttribute?.('src') || '', alt: desktop.getAttribute?.('alt') || '未设置alt属性', width: desktop.getAttribute?.('width') || '自适应', height: desktop.getAttribute?.('height') || '自适应', }, mobile: { src: mobile.getAttribute?.('src') || '', alt: mobile.getAttribute?.('alt') || '未设置alt属性', width: mobile.getAttribute?.('width') || '自适应', height: mobile.getAttribute?.('height') || '自适应', }, }); } let resultHTML = ` <div class='img_compare_container'> <div class='img_column'> <h3>${leftLabel} iframe (${desktopImages.length}张图片)：</h3> </div> <div class='img_column'> <h3>${rightLabel} iframe (${mobileImages.length}张图片)：</h3> </div> </div> <div class='img_rows'> ${rowPairs .map( (pair, index) => ` <div class='img_row_pair'> <div class='img_item'> <div>图片 ${index + 1}</div> <div class='img_content'> <div class='img_preview_container'> ${ pair.desktop.src ? `<img src='${pair.desktop.src}' alt='${pair.desktop.alt}' class='img_preview'>` : `<div style='color: #999;'>无图片</div>` } </div> <div class='img_info'> <div class='img_info_row'> <span class='img_info_label'>Alt文本:</span> <span class='img_info_value'>${pair.desktop.alt}</span> </div> <div class='img_info_row'> <span class='img_info_label'>宽度:</span> <span class='img_info_value'>${pair.desktop.width}</span> </div> <div class='img_info_row'> <span class='img_info_label'>高度:</span> <span class='img_info_value'>${pair.desktop.height}</span> </div> </div> </div> <div class='img_src_container'> <a href='${pair.desktop.src}' target='_blank' class='img_src'>${ pair.desktop.src || '无' }</a> </div> </div> <div class='img_item'> <div>图片 ${index + 1}</div> <div class='img_content'> <div class='img_preview_container'> ${ pair.mobile.src ? `<img src='${pair.mobile.src}' alt='${pair.mobile.alt}' class='img_preview'>` : `<div style='color: #999;'>无图片</div>` } </div> <div class='img_info'> <div class='img_info_row'> <span class='img_info_label'>Alt文本:</span> <span class='img_info_value'>${pair.mobile.alt}</span> </div> <div class='img_info_row'> <span class='img_info_label'>宽度:</span> <span class='img_info_value'>${pair.mobile.width}</span> </div> <div class='img_info_row'> <span class='img_info_label'>高度:</span> <span class='img_info_value'>${pair.mobile.height}</span> </div> </div> </div> <div class='img_src_container'> <a href='${pair.mobile.src}' target='_blank' class='img_src'>${ pair.mobile.src || '无' }</a> </div> </div> </div> ` ) .join('')} </div> <div class='img_summary'> <h3>图片对比分析：</h3> <div class='cid_link'> ${leftLabel}图片数量: ${desktopImages.length}<br> ${rightLabel}图片数量: ${mobileImages.length}<br> ${ desktopImages.length !== mobileImages.length ? `<div style='color: red;'>警告：${leftLabel}和${rightLabel} iframe中的图片数量不一致！</div>` : `<div style='color: green;'>两侧iframe中的图片数量一致</div>` } </div> <h3 style='margin-top: 20px;'>Alt属性对比：</h3> ${compareAlts( rowPairs.map((p) => p.desktop), rowPairs.map((p) => p.mobile) )} </div> `; document.querySelector('.img_modal').innerHTML = resultHTML; } function compareAlts(desktopImages, mobileImages) { let differences = []; const maxLength = Math.max(desktopImages.length, mobileImages.length); for (let i = 0; i < maxLength; i++) { const desktop = desktopImages[i]; const mobile = mobileImages[i]; if (desktop && mobile && desktop.alt !== mobile.alt) { differences.push(` <div class='img_item' style='color: red;'> <div>图片 ${i + 1}的Alt属性不一致：</div> <div>${leftLabel} Alt: ${desktop.alt}</div> <div>${rightLabel} Alt: ${mobile.alt}</div> </div> `); } } if (differences.length === 0) { return `<div style='color: green;'>所有图片的Alt属性都一致</div>`; } return differences.join(''); } let htmlContent = ` <div id='cid_overlay' class='cid_overlay'> <div class='cid_modal'> </div> </div> `; let button = ` <li id='openCidBtn' class='nav-item'> <a class='nav-link'>检查CID</a> </li> `; let localHtmlContent = ` <div id='local_overlay' class='local_overlay'> <div class='local_modal'> </div> </div> `; let localButton = ` <li id='openLocalBtn' class='nav-item'> <a class='nav-link'>检查链接本地化</a> </li> `; let imgHtmlContent = ` <div id='img_overlay' class='img_overlay'> <div class='img_modal'> </div> </div> `; let imgButton = ` <li id='openImgBtn' class='nav-item'> <a class='nav-link'>检查图片</a> </li> `; document.body.insertAdjacentHTML('afterbegin', htmlContent); navbar_nav.insertAdjacentHTML('beforeend', button); document.body.insertAdjacentHTML('afterbegin', localHtmlContent); navbar_nav.insertAdjacentHTML('beforeend', localButton); document.body.insertAdjacentHTML('afterbegin', imgHtmlContent); navbar_nav.insertAdjacentHTML('beforeend', imgButton); const openCidBtn = document.getElementById('openCidBtn'); const overlay = document.getElementById('cid_overlay'); const openLocalBtn = document.getElementById('openLocalBtn'); const localOverlay = document.getElementById('local_overlay'); const openImgBtn = document.getElementById('openImgBtn'); const imgOverlay = document.getElementById('img_overlay'); openCidBtn.onclick = () => { overlay.style.display = 'flex'; checkCID(); }; overlay.onclick = (event) => { if (event.target === overlay) { overlay.style.display = 'none'; } }; openLocalBtn.onclick = () => { localOverlay.style.display = 'flex'; checkLocalization(); }; localOverlay.onclick = (event) => { if (event.target === localOverlay) { localOverlay.style.display = 'none'; } }; openImgBtn.onclick = () => { imgOverlay.style.display = 'flex'; checkImages(); }; imgOverlay.onclick = (event) => { if (event.target === imgOverlay) { imgOverlay.style.display = 'none'; } };})()
">
            Url Cid Check</a>
            
            <a class="layui-btn layui-btn-primary layui-border-orange layui-btn-radius"
            href="javascript:(function(){let iframewindow_des = document.getElementById('iframe_0').contentWindow; let iframewindow_mob = document.getElementById('iframe_1').contentWindow; const left_desktopContainer = iframewindow_des.document.querySelector('.desktop-container'); const left_mobileContainer = iframewindow_des.document.querySelector('.mobile-container'); const right_desktopContainer = iframewindow_mob.document.querySelector('.desktop-container'); const right_mobileContainer = iframewindow_mob.document.querySelector('.mobile-container'); const usContainer = iframewindow_mob.document.querySelector('.desktop-container'); const left_sfcopy = iframewindow_des.document.querySelector('.sfcopy'); const right_sfcopy = iframewindow_mob.document.querySelector('.sfcopy'); const footerContainer = iframewindow_des.document.querySelector('.shared-footer'); const footerUSContainer = iframewindow_mob.document.querySelector('.shared-footer'); const navbar_nav = document.querySelector('.navbar-nav'); const selectElement = 'h1,h2,h3,h4,h5,h6,p'; const specialSupElement = '*' || '†' || 'Δ' || '°' || '◊' || '⧧'; const style = document.createElement('style'); style.textContent = ` #openLinkBtn { cursor: pointer; } .tool_overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.5); justify-content: center; align-items: center; z-index: 1000; } .tool_modal { background-color: #fff; padding: 30px; border-radius: 8px; box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1); text-align: center; font-size: 12px; max-width: 90vw; overflow:auto; height:100vh; } .tool_modal b{ line-height: 30px; font-size:14px; } .tool_table { width: 100%; border-collapse: collapse; font-size:14px; } .tool_table table, .tool_table th, .tool_table td { border: 1px solid black; } .tool_table th, .tool_table td { padding: 8px; text-align: center; height:auto; } .tool_table th { background-color: #ccc; } .tool_table tr:nth-child(2n){ background-color: #eee; } a{ text-decoration: none; } td img{ width:100px; height:auto; } `; document.head.appendChild(style); let filtered_1 = Array.from([ ...left_desktopContainer.querySelectorAll(selectElement), ]).filter((o) => { return o.textContent.includes('*'); }); let filtered_2 = Array.from([ ...left_mobileContainer.querySelectorAll(selectElement), ]).filter((o) => { return o.textContent.includes('*'); }); const sup = [...left_desktopContainer.querySelectorAll('sup')]; const sups = [...left_mobileContainer.querySelectorAll('sup')]; function findParentElement(element) { let parent = element; while ( parent && parent.tagName !== ('P' || 'H1' || 'H2' || 'H3' || 'H4' || 'H5' || 'H6') ) { parent = parent.parentElement; } return parent; } let tableData = []; filtered_1.forEach((o) => { const legalSpan = Array.from(left_sfcopy.querySelectorAll('span')).find( (span) => span.textContent.trim() === '*' ); tableData.push({ footNum: '*', footHtml: findParentElement(o).textContent, footLegal: legalSpan.closest('p').innerText, }); }); sup.forEach((o) => { const legalSpan = Array.from(left_sfcopy.querySelectorAll('span')).find( (span) => span.textContent.trim() === o.innerText + '.' ); tableData.push({ footNum: o.innerText, footHtml: findParentElement(o).textContent, footLegal: legalSpan.closest('p').innerText, }); }); let mobileData = []; filtered_2.forEach((o) => { const legalSpan = Array.from(left_sfcopy.querySelectorAll('span')).find( (span) => span.textContent.trim() === '*' ); mobileData.push({ footNum: '*', footHtml: findParentElement(o).textContent, footLegal: legalSpan.closest('p').innerText, }); }); sups.forEach((o) => { const legalSpan = Array.from(left_sfcopy.querySelectorAll('span')).find( (span) => span.textContent.trim() === o.innerText + '.' ); mobileData.push({ footNum: o.innerText, footHtml: findParentElement(o).textContent, footLegal: legalSpan.closest('p').innerText, }); }); let htmlContent = ` <div id='tool_overlay' class='tool_overlay'> <div class='tool_modal'> <b>Desktop 角标</b> <table class='tool_table'> <colgroup> <col> <col> <col> <col> </colgroup> <thead> <tr> <th>角标</th> <th>角标所在段落</th> <th>角标对应legal</th> </tr> </thead> <tbody> ${tableData .map( (o) => `<tr> <td>${o.footNum}</td> <td>${o.footHtml}</td> <td>${o.footLegal}</td> </tr>` ) .join('')} </tbody> </table> <br> <b>Mobile 角标</b> <table class='tool_table'> <colgroup> <col> <col> <col> <col> </colgroup> <thead> <tr> <th>角标</th> <th>角标所在段落</th> <th>角标对应legal</th> </tr> </thead> <tbody> ${mobileData .map( (o) => `<tr> <td>${o.footNum}</td> <td>${o.footHtml}</td> <td>${o.footLegal}</td> </tr>` ) .join('')} </tbody> </table> </div> </div> `; let lis = ` <li id='openLinkBtn' class='nav-item'> <a class='nav-link'>角标列表</a> </li> `; document.body.insertAdjacentHTML('afterbegin', htmlContent); navbar_nav.insertAdjacentHTML('beforeend', lis); const openLinkBtn = document.getElementById('openLinkBtn'); const overlay = document.getElementById('tool_overlay'); openLinkBtn.onclick = () => { overlay.style.display = 'flex'; }; overlay.onclick = (event) => { if (event.target === overlay) { overlay.style.display = 'none'; } };})()">
            FootNote Check</a>
            
            <a class="layui-btn layui-btn-primary layui-border-orange layui-btn-radius"
            href="javascript:(function(){let iframewindow_des = document.getElementById('iframe_0').contentWindow; let iframewindow_mob = document.getElementById('iframe_1').contentWindow; const desktopContainer = iframewindow_des.document.querySelector('.desktop-container'); const mobileContainer = iframewindow_mob.document.querySelector('.mobile-container'); const style = document.createElement('style'); style.textContent = ` .unicode_overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.5); display: flex; justify-content: center; align-items: center; z-index: 1000000; } .unicode_modal { background-color: #fff; border-radius: 8px; box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2); max-width: 90%; max-height: 90%; overflow: auto; padding: 20px; width: 800px; } .unicode_header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 10px; } .unicode_title { font-size: 18px; font-weight: bold; margin: 0; } .unicode_close { background: none; border: none; cursor: pointer; font-size: 20px; } .unicode_result { margin-bottom: 15px; padding: 10px 15px; border-radius: 4px; } .unicode_success { background-color: #e6ffe6; color: #008000; } .unicode_error { background-color: #fff0f0; color: #d32f2f; } .unicode_item { background-color: #f5f5f5; margin-bottom: 15px; padding: 15px; border-radius: 4px; } .unicode_path { color: #666; font-size: 12px; margin-bottom: 8px; } .unicode_text { line-height: 1.6; } .unicode_char { background-color: #ffcdd2; color: #d32f2f; padding: 2px 4px; border-radius: 2px; display: inline-block; margin: 2px; } .unicode_info { margin-top: 8px; font-size: 13px; color: #666; } .unicode_code { font-family: monospace; background-color: #f0f0f0; padding: 1px 4px; border-radius: 2px; } .unicode_suggestion { margin-top: 4px; color: #1976d2; } .unicode_summary { margin-top: 20px; border-top: 1px solid #eee; padding-top: 15px; } `; document.head.appendChild(style); const commonErrors = { '⻓': '长', '⾏': '行', '⽉': '月', '⼊': '入', '⻔': '门', '⼯': '工', '⼦': '子', '⼼': '心', '⼈': '人', '⽅': '方', '⽔': '水', '⽕': '火', '⻝': '食', '⻋': '车', '⾦': '金', '⼟': '土', '⽰': '示', '⼤': '大', '⼩': '小', '⾁': '肉', '⾨': '门' }; function collectTextNodes(node, path = '', result = []) { if (node.nodeType === Node.TEXT_NODE) { const text = node.textContent.trim(); if (text && text.length > 0) { result.push({ node: node, text: text, path: path }); } } else if (node.nodeType === Node.ELEMENT_NODE) { const tagName = node.tagName.toLowerCase(); if (['script', 'style', 'noscript', 'svg', 'code', 'pre'].includes(tagName)) { return result; } const style = window.getComputedStyle(node); if (style.display === 'none' || style.visibility === 'hidden') { return result; } const newPath = path ? `${path} > ${tagName}` : tagName; for (let i = 0; i < node.childNodes.length; i++) { collectTextNodes(node.childNodes[i], newPath, result); } } return result; } function checkSpecialCharacters(textNode) { const text = textNode.text; const specialChars = []; for (let i = 0; i < text.length; i++) { const char = text.charAt(i); if (commonErrors[char]) { specialChars.push({ char: char, index: i, suggestion: commonErrors[char], unicode: `U+${char.charCodeAt(0).toString(16).toUpperCase().padStart(4, '0')}`, reason: '部首字符，应替换为常规汉字' }); continue; } if (/[\u2E80-\u2EFF\u2F00-\u2FDF\u31C0-\u31EF\u3200-\u32FF\u3400-\u4DBF\uF900-\uFAFF]/.test(char)) { const possibleChar = inferCompleteCharacter(char); specialChars.push({ char: char, index: i, suggestion: possibleChar || '请替换为对应的完整汉字', unicode: `U+${char.charCodeAt(0).toString(16).toUpperCase().padStart(4, '0')}`, reason: '部首或部件字符' }); continue; } if (isCJKCharacter(char) && !isCommonCJKCharacter(char)) { specialChars.push({ char: char, index: i, suggestion: '请检查并替换为正确汉字', unicode: `U+${char.charCodeAt(0).toString(16).toUpperCase().padStart(4, '0')}`, reason: '非标准中文字符区域' }); continue; } if (/[\u3000-\u303F\uFF00-\uFFEF]/.test(char) && !/[\s，。？！：；''''【】、]/.test(char)) { const code = char.charCodeAt(0); if ((code >= 0x3000 && code <= 0x303F) || (code >= 0xFF00 && code <= 0xFFEF)) { if (![0x3000, 0x3001, 0x3002].includes(code) && !(code >= 0xFF01 && code <= 0xFF0F) && !(code >= 0xFF1A && code <= 0xFF20) && !(code >= 0xFF3B && code <= 0xFF40) && !(code >= 0xFF5B && code <= 0xFF65)) { specialChars.push({ char: char, index: i, suggestion: '检查是否为正确字符', unicode: `U+${code.toString(16).toUpperCase().padStart(4, '0')}`, reason: '非常见中文字符' }); } } } } if (specialChars.length > 0) { return { ...textNode, specialChars: specialChars }; } return null; } function isCommonCJKCharacter(char) { const code = char.charCodeAt(0); return (code >= 0x4E00 && code <= 0x9FFF); } function isCJKCharacter(char) { const code = char.charCodeAt(0); return ( (code >= 0x4E00 && code <= 0x9FFF) || (code >= 0x3400 && code <= 0x4DBF) || (code >= 0x20000 && code <= 0x2A6DF) || (code >= 0x2A700 && code <= 0x2B73F) || (code >= 0x2B740 && code <= 0x2B81F) || (code >= 0x2B820 && code <= 0x2CEAF) || (code >= 0x2CEB0 && code <= 0x2EBEF) || (code >= 0x30000 && code <= 0x3134F) || (code >= 0xF900 && code <= 0xFAFF) || (code >= 0x2F800 && code <= 0x2FA1F) ); } function inferCompleteCharacter(char) { const codePoint = char.charCodeAt(0); const specialRanges = [ [0x2E80, 0x2EFF], [0x2F00, 0x2FDF], [0x31C0, 0x31EF], [0x2FF0, 0x2FFF], [0x3000, 0x303F], [0x3130, 0x318F], [0xFE30, 0xFE4F], [0x2E00, 0x2E5F] ]; for (const [start, end] of specialRanges) { if (codePoint >= start && codePoint <= end) { return smartRadicalInference(char, codePoint, start, end); } } function smartRadicalInference(char, codePoint, rangeStart, rangeEnd) { const commonRadicalMistakes = { 0x2E84: '木', 0x2E86: '水', 0x2E87: '火', 0x2E88: '牛', 0x2E89: '犬', 0x2E8A: '玉', 0x2E8C: '目', 0x2E8D: '矢', 0x2E95: '石', 0x2E9E: '示', 0x2EA5: '糸', 0x2EAA: '言', 0x2EAD: '車', 0x2EB3: '邑', 0x2EB8: '金', 0x2EBB: '門', 0x2ECA: '頁', 0x2ED8: '鳥', 0x2ECE: '齒', 0x2ED4: '黽', 0x2ED9: '鼎', }; if (commonRadicalMistakes[codePoint]) { return commonRadicalMistakes[codePoint]; } if (rangeStart === 0x2E80 && rangeEnd === 0x2EFF) { } return null; } const commonComponents = { '⺀': '丿', '⺁': '乙', '⺂': '亠', '⺃': '人', '⺄': '儿', '⺅': '入', '⺆': '八', '⺇': '冂', '⺉': '刀', '⺊': '力', '⺋': '匕', '⺌': '十', '⺍': '卜', '⺎': '又', }; if (commonComponents[char]) { return commonComponents[char]; } const possibleCJKChar = String.fromCodePoint(codePoint + 0x4000); if (isCJKCharacter(possibleCJKChar)) { return possibleCJKChar; } return null; } function highlightText(text, specialChars) { const textArray = text.split(''); const markers = new Array(text.length).fill(null); specialChars.forEach(charInfo => { if (charInfo.index >= 0 && charInfo.index < text.length) { markers[charInfo.index] = charInfo; } }); let result = ''; let currentIndex = 0; while (currentIndex < textArray.length) { const marker = markers[currentIndex]; if (marker) { const tooltipContent = `Unicode: ${marker.unicode}\n建议替换为: ${marker.suggestion}\n原因: ${marker.reason}`; result += `<span class='unicode_char' title='${tooltipContent}'>${textArray[currentIndex]}</span>`; } else { result += textArray[currentIndex]; } currentIndex++; } return result; } function detectSpecialCharacters(container) { const textNodes = collectTextNodes(container); const problematicNodes = []; textNodes.forEach(textNode => { const result = checkSpecialCharacters(textNode); if (result) { problematicNodes.push(result); } }); return problematicNodes; } const navbar_nav = document.querySelector('.navbar-nav'); let lis = ` <li id='openUnicodeCheckBtn' class='nav-item'> <a class='nav-link'>检查特殊字符</a> </li> `; navbar_nav.insertAdjacentHTML('beforeend', lis); document.getElementById('openUnicodeCheckBtn').addEventListener('click', function() { const overlay = document.createElement('div'); overlay.className = 'unicode_overlay'; overlay.innerHTML = ` <div class='unicode_modal'> <div class='unicode_header'> <h2 class='unicode_title'>特殊字符检测工具</h2> <button class='unicode_close'>&times;</button> </div> <div class='unicode_content'>正在检测页面中的特殊字符...</div> </div> `; document.body.appendChild(overlay); const containers = [desktopContainer, mobileContainer]; const allProblematicNodes = containers.reduce((acc, container) => { if (container) { return acc.concat(detectSpecialCharacters(container)); } return acc; }, []); const contentDiv = overlay.querySelector('.unicode_content'); if (allProblematicNodes.length === 0) { contentDiv.innerHTML = ` <div class='unicode_result unicode_success'> <h3>恭喜！未检测到页面中的特殊字符。</h3> <p>当前页面的中文字符都是正常的汉字。</p> </div> `; } else { contentDiv.innerHTML = ` <div class='unicode_result unicode_error'> <h3>发现 ${allProblematicNodes.length} 处文本包含特殊字符</h3> <p>特殊字符可能会导致显示问题、搜索引擎识别问题或无障碍访问障碍。</p> </div> <div class='unicode_problems'> ${allProblematicNodes.map((node, index) => ` <div class='unicode_item'> <div class='unicode_path'>位置 ${index + 1}: ${node.path}</div> <div class='unicode_text'>${highlightText(node.text, node.specialChars)}</div> <div class='unicode_info'> 发现 ${node.specialChars.length} 个特殊字符： ${node.specialChars.map(charInfo => ` <div> <span class='unicode_code'>${charInfo.char}</span> (${charInfo.unicode}): ${charInfo.reason} <div class='unicode_suggestion'>建议替换为: ${charInfo.suggestion}</div> </div> `).join('')} </div> </div> `).join('')} </div> <div class='unicode_summary'> <h3>总结</h3> <p>页面中共检测到 ${allProblematicNodes.length} 处文本包含问题，涉及 ${allProblematicNodes.reduce((sum, node) => sum + node.specialChars.length, 0)} 个特殊字符。</p> <p>建议修复这些特殊字符，以确保页面内容的正确显示和可访问性。</p> </div> `; } const closeButton = overlay.querySelector('.unicode_close'); closeButton.addEventListener('click', function() { document.body.removeChild(overlay); }); overlay.addEventListener('click', function(e) { if (e.target === overlay) { document.body.removeChild(overlay); } }); });})()">
            Unicode Check</a>
        </div>
        <hr>
        <div class="a-box">
            <a class="layui-btn layui-btn-primary layui-border-blue layui-btn-radius"
            href="javascript:(function(){let url_cur = window.location.href; let is_cn = false; if (url_cur.includes('.com/cn') || url_cur.includes('.com.cn')) { is_cn = true; } let reg = /\.com(\/hk\/en|\/hk|\/tw|\/mo|\/cn|\.cn)?/; url_cur = reg.test(url_cur) ? url_cur.replace(reg, '.com/cn') : url_cur.replace(/\.com(\/.*)?/, '.com/cn'); let new_Window = ''; if (is_cn) { changeImgSrc(window); } else { new_Window = window.open(url_cur, '_blank'); } function changeImgSrc(newWindow) { let iframewindow_des = newWindow.document.getElementById('iframe_0').contentWindow; let iframewindow_mob = newWindow.document.getElementById('iframe_1').contentWindow; const images_des = iframewindow_des.document.getElementsByTagName('img'); const images_mob = iframewindow_mob.document.getElementsByTagName('img'); function changeImgEach(images) { for (let img of images) { img.src = img.src ? img.src.replace(/\.com\.cn/g, '.com/cn') : ''; } } changeImgEach(images_des); changeImgEach(images_mob); } new_Window.onload = function () { changeImgSrc(new_Window); };})()
">
            To /CN Url</a>
        </div>
        <hr>
        <div class="a-box">
            <a class="layui-btn layui-btn-primary layui-border-red layui-btn-radius"
            href="javascript:(function(){if(window.syncScrollEnabled)return;window.syncScrollEnabled=true;let s=document.createElement('script');s.textContent=`(function(){let c=new BroadcastChannel('scroll-sync');let i=false;window.addEventListener('scroll',()=>{if(!i){c.postMessage({scrollTop:window.scrollY,timestamp:Date.now()})}});c.addEventListener('message',e=>{i=true;window.scrollTo({top:e.data.scrollTop,behavior:'auto'});setTimeout(()=>{i=false},0)})})()`;document.head.appendChild(s);})();
">
            Scroll Sync</a>

            <a class="layui-btn layui-btn-primary layui-border-purple layui-btn-radius"
            href="javascript:(function(){function makeTextCopyable() { const iframeWindow = document.getElementById('iframe_2').contentWindow; const iframeDocument = iframeWindow.document; const originalColor = 'rgba(255, 0, 0, 0.6)'; const style = iframeDocument.createElement('style'); style.textContent = ` .copyable-text { cursor: pointer; border-radius: 3px; padding: 0 2px; white-space: pre-wrap; } .copyable-text:hover { background-color: ${originalColor}; border: 1px solid ${originalColor} transition: all 0.6s ease; } `; iframeDocument.head.appendChild(style); function processTextNodes(element) { if (element.tagName === 'SCRIPT' || element.tagName === 'STYLE') { return; } for (let i = 0; i < element.childNodes.length; i++) { const node = element.childNodes[i]; if (node.nodeType === Node.TEXT_NODE && node.textContent.trim() !== '') { const spanElement = iframeDocument.createElement('span'); spanElement.textContent = node.textContent.trim(); spanElement.className = 'copyable-text'; spanElement.title = '点击复制: ' + node.textContent.trim(); spanElement.addEventListener('click', function(e) { e.stopPropagation(); const textToCopy = this.textContent.trim(); navigator.clipboard.writeText(textToCopy) .then(() => { this.style.border = `1px solid ${originalColor}`; const tooltip = iframeDocument.createElement('div'); tooltip.textContent = '已复制'; tooltip.style.position = 'fixed'; tooltip.style.backgroundColor = 'rgba(0, 0, 0, 0.8)'; tooltip.style.color = 'white'; tooltip.style.padding = '5px 10px'; tooltip.style.borderRadius = '4px'; tooltip.style.fontSize = '12px'; tooltip.style.zIndex = '9999'; tooltip.style.top = (e.clientY - 30) + 'px'; tooltip.style.left = e.clientX + 'px'; tooltip.style.boxShadow = '0 2px 5px rgba(0,0,0,0.3)'; iframeDocument.body.appendChild(tooltip); setTimeout(() => { tooltip.remove(); this.style.border = `0px solid ${originalColor}`; }, 700); }) .catch(err => { console.error('复制失败:', err); }); }); node.parentNode.replaceChild(spanElement, node); } else if (node.nodeType === Node.ELEMENT_NODE) { processTextNodes(node); } } } processTextNodes(iframeDocument.body); const infoDiv = iframeDocument.createElement('div'); infoDiv.textContent = '鼠标点击可复制文本'; infoDiv.style.position = 'fixed'; infoDiv.style.top = '5px'; infoDiv.style.right = '5px'; infoDiv.style.backgroundColor = 'rgba(0, 0, 0, 0.8)'; infoDiv.style.color = 'white'; infoDiv.style.padding = '8px 12px'; infoDiv.style.borderRadius = '4px'; infoDiv.style.fontSize = '13px'; infoDiv.style.fontWeight = 'bold'; infoDiv.style.zIndex = '9999'; infoDiv.style.boxShadow = '0 2px 5px rgba(0,0,0,0.3)'; iframeDocument.body.appendChild(infoDiv); } let copyEnabled = false; function toggleTextCopy() { if (!copyEnabled) { makeTextCopyable(); copyEnabled = true; } else { document.getElementById('iframe_2').src = document.getElementById('iframe_2').src; copyEnabled = false; } } toggleTextCopy();})()">
            Text Copy</a>

            <a class="layui-btn layui-btn-primary layui-border-purple layui-btn-radius"
            href="javascript:(function(){(function() { function applyMobileStyles() { const styleEl = document.createElement('style'); styleEl.id = 'mobile-adaptive-styles'; const mobileStyles = ` .desktop-container { display: none !important; } .mobile-container { display: block !important; width: 100% !important; height: inherit !important; overflow: visible !important; } .sfnav, .shared-footer-content { padding: 0 !important; } .shared-footer-content table.sf-content-container { width: 100% !important; max-width: 414px !important; padding-top: 0 !important; } .sf-content-container-td { padding: 0 6.25% !important; } .shared-footer-content table.sf-content-inner { width: 100% !important; max-width: 362px !important; padding-top: 0 !important; } .sfnav p { font-size: 12px !important; line-height: 39px !important; padding: 0 !important; } .sfnav span.vert { font-size: 0; line-height: 0; display: block; } .sflinks, .sflinks p { line-height: 20px !important; } .shared-footer .sfcopy p .inline-address a, .shared-footer .sfcopy p .inline-cta a, .shared-footer .sfcopy p a[href^='tel:'], .shared-footer .sfcopy.sftm p.tmcopy .inline-address a, .shared-footer .sfcopy.sftm p.tmcopy .inline-cta a, .sf-content-container a[href^='tel:'] { color: inherit !important; } .shared-footer .sf-content-container, .shared-footer .sf-content-inner, .shared-footer.shared-footer { background-color: #f5f5f7 !important; } .shared-footer .sfcopy, .shared-footer .sfcopy p, .shared-footer .sflinks { text-align: left !important; } .shared-footer .sfnav { border-top: none !important; } .shared-footer .sfnav span.vert { border-top: 1px solid #d2d2d7; } .shared-footer .sfnav.custom-keyline { border-bottom: 0 !important; } .shared-footer .sfcopy, .shared-footer .sfcopy p, .shared-footer .sflinks .vert { color: #6e6e73 !important; } .shared-footer .sfcopy p a, .shared-footer .sflinks p, .shared-footer .sflinks p a, .shared-footer .sfnav p span.eyebrow { color: #424245 !important; } .shared-footer .sfnav p .eyebrow { color: #424245 !important; display: inline-block; width: 100%; } `; styleEl.textContent = mobileStyles; document.head.appendChild(styleEl); if (!document.querySelector(`meta[name='viewport']`)) { const metaViewport = document.createElement('meta'); metaViewport.name = 'viewport'; metaViewport.content = 'width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no'; document.head.appendChild(metaViewport); } console.log('已应用移动端样式'); } function initMobileAdaption() { applyMobileStyles(); document.querySelectorAll('img').forEach(img => { if (img.width > window.innerWidth) { img.style.maxWidth = '100%'; img.style.height = 'auto'; } }); document.querySelectorAll('.desktop-container').forEach(el => { el.style.display = 'none'; }); document.querySelectorAll('.mobile-container').forEach(el => { el.style.display = 'block'; }); } if (document.readyState === 'loading') { document.addEventListener('DOMContentLoaded', initMobileAdaption); } else { initMobileAdaption(); } window.addEventListener('resize', initMobileAdaption); })();})()">
            Mobile Converter</a>
        </div>
        <hr>
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        const aBoxes = document.querySelectorAll('.a-box');
        
        aBoxes.forEach(aBox => {
            const buttons = aBox.querySelectorAll('.layui-btn');
            
            buttons.forEach(button => {
                button.setAttribute('draggable', 'true');
                
                button.addEventListener('dragstart', function(e) {
                    e.dataTransfer.setData('text/plain', '');  // 必须设置数据才能拖动
                    this.classList.add('dragging');
                    
                    // 记录起始位置
                    e.dataTransfer.setData('sourceBox', this.closest('.a-box').dataset.boxId);
                    e.dataTransfer.setData('sourceIndex', Array.from(this.parentNode.children).indexOf(this));
                });
                
                button.addEventListener('dragend', function() {
                    this.classList.remove('dragging');
                    document.querySelectorAll('.drag-over').forEach(el => el.classList.remove('drag-over'));
                });
                
                button.addEventListener('dragover', function(e) {
                    e.preventDefault();
                    this.classList.add('drag-over');
                });
                
                button.addEventListener('dragleave', function() {
                    this.classList.remove('drag-over');
                });
                
                button.addEventListener('drop', function(e) {
                    e.preventDefault();
                    this.classList.remove('drag-over');
                    
                    const draggingElement = document.querySelector('.dragging');
                    if (draggingElement && this !== draggingElement) {
                        // 获取两个元素的位置
                        const allButtons = [...this.parentNode.children];
                        const fromIndex = allButtons.indexOf(draggingElement);
                        const toIndex = allButtons.indexOf(this);
                        
                        // 交换位置
                        if (fromIndex !== -1) {
                            if (fromIndex < toIndex) {
                                this.parentNode.insertBefore(draggingElement, this.nextSibling);
                            } else {
                                this.parentNode.insertBefore(draggingElement, this);
                            }
                        } else {
                            // 从其他.a-box拖来的情况
                            this.parentNode.insertBefore(draggingElement, this);
                        }
                    }
                });
            });
            
            // 允许在空白区域放置
            aBox.addEventListener('dragover', function(e) {
                e.preventDefault();
                const draggingElement = document.querySelector('.dragging');
                if (!draggingElement) return;
                
                const afterElement = getDragAfterElement(aBox, e.clientY);
                if (afterElement) {
                    aBox.insertBefore(draggingElement, afterElement);
                } else {
                    aBox.appendChild(draggingElement);
                }
            });
        });
        
        // 辅助函数：获取鼠标位置后的元素
        function getDragAfterElement(container, y) {
            const draggableElements = [...container.querySelectorAll('.layui-btn:not(.dragging)')];
            
            return draggableElements.reduce((closest, child) => {
                const box = child.getBoundingClientRect();
                const offset = y - box.top - box.height / 2;
                
                if (offset < 0 && offset > closest.offset) {
                    return { offset: offset, element: child };
                } else {
                    return closest;
                }
            }, { offset: Number.NEGATIVE_INFINITY }).element;
        }
    });
    </script>

</body>

</html>